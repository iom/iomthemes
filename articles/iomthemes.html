<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Creating IOM-Branded Data Visualizations with {iomthemes} • iomthemes</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Fira_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Creating IOM-Branded Data Visualizations with {iomthemes}">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">iomthemes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/iomthemes.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/iom/iomthemes/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Creating IOM-Branded Data Visualizations with {iomthemes}</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/iom/iomthemes/blob/master/vignettes/iomthemes.Rmd" class="external-link"><code>vignettes/iomthemes.Rmd</code></a></small>
      <div class="d-none name"><code>iomthemes.Rmd</code></div>
    </div>

    
    
<p>Data visualization is a powerful tool for conveying insights from
complex datasets and telling compelling stories. The <a href="https://www.iom.int" class="external-link">International Organisation for Migration</a>
(IOM) supports governments in promoting safe and humane migration. Using
data to tell <strong>evidence-based stories about migration</strong> is
critical for IOM’s mission.</p>
<p>The <a href="https://github.com/iom/iomthemes" class="external-link">iomthemes</a> package, built on the versatile ggplot2
library, offers a practical solution for creating professional,
publication-level IOM-branded data stories</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Effective chart are first those that <strong>support a
message</strong>. From the same data set a multiplicity of chart can be
produced. The best chart is the one that present in the most powerful
way the message that you want to pass-on through the story the data
allow you to tell.</p>
<div class="section level3">
<h3 id="minimalistic-design">Minimalistic Design<a class="anchor" aria-label="anchor" href="#minimalistic-design"></a>
</h3>
<blockquote>
<p>“<em>Graphical elegance is often found in simplicity of design and
complexity of data.</em>”Edward Tufte</p>
</blockquote>
<p>The main rule to achieving can be summarised as: “<strong>Do keep the
chart as simple as possible</strong>”. A common mistake we all make with
charts is overdressing them with unnecessary elements and details. The
usual suspects are excess color, graphical clutter and abuse of special
effects. Details like these won’t impress anyone but de-cluttering your
charts will. To do so:</p>
<ul>
<li><p><strong>Outline the message</strong>: Always use the main
conclusion you want to draw within the title of the chart, use the
subtitle to present the data that you have used in the chart. annotation
in the chart can also help explaining why the chart is an evidence of
the message you present. The message resides in the shape of the data.
Chart titles should be clear and accurate, includes time increment and
units.</p></li>
<li><p><strong>Focus on legibility</strong>: Graph should be designed to
highlight trends, patterns and make exceptions more visible. They can
also be designed to reveal relationships among multiple values. For
instance, for bar graph presenting categories, do use a horizontal bar
graph and arrange data from greatest to least in descending
order.</p></li>
<li><p><strong>Use color to communicate information and not for
decoration</strong>. Too many colors can confuse and disorient. When
designing a graph, color can be both your friend and your enemy.
Depending on how we use it, it can either gracefully highlight data and
show changes, or create visual overload and confuse the audience. Don’t
use more than six colors or six different categories within the same
chart: human brain cannot process more than this.</p></li>
<li><p><strong>Reshape first your data</strong>: A good chart establish
a balance between content &amp; message: Too many content -&gt; not
legible; Not enough content -&gt; not precise. Therefore, the content
(i.e. the data) shall be adjusted content to message. For instance,
extra decimal places look impressive and imply accuracy, but they’re
often pointless. So, take a step back and round numbers off before
plotting. Overstating the numerical precision of your data by showing
too many decimal places can make your chart seem accurate, but this
specificity is just misleading. Even when you don’t exaggerate the
precision of your data, and your numbers are genuinely accurate,
overloading your audience with such detail is often useless</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="telling-story-with-data">Telling Story with Data<a class="anchor" aria-label="anchor" href="#telling-story-with-data"></a>
</h3>
<p>Data stories needs to align to a narrative frame, that often falls in
one the class below :</p>
<ol style="list-style-type: decimal">
<li><p>Shed light on a previously unexplored topic, ,</p></li>
<li><p>Introduce an interesting angle,</p></li>
<li><p>Provide useful suggestions to solve a problem,</p></li>
<li><p>Disprove an hypothesis / debunk a widely held belief
assumption.</p></li>
</ol>
<p>When designing a chart using ggplot2 in R, beside crafting an
insightful message, though your title and subtitle, the following
<strong>data storytelling techniques</strong> can be practically
applied:</p>
<ul>
<li><p><strong>Narrative Arc</strong>: Structure your chart to follow a
clear beginning, middle, and end. Start by setting up the context with
initial data points, show the progression or trend, and conclude with
the key insights. In <a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a>, you can use
<code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line()</a></code> for trends and <code><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate()</a></code> to add
narrative elements.</p></li>
<li><p><strong>Highlighting Key Insights</strong>: Use colors and
annotations to draw attention to important data points. In
<a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a>, you can use <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point()</a></code> with
specific colors and <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text()</a></code> for annotations.</p></li>
<li><p><strong>Comparative Analysis</strong>: Design charts that compare
different datasets or time periods. Use <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap()</a></code> or
<code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid()</a></code> to create side-by-side comparisons.</p></li>
<li><p><strong>Contextualization</strong>: Provide context by adding
reference lines or shaded areas. Use <code><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline()</a></code>,
<code><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline()</a></code>, or <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect()</a></code> in
<a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a>.</p></li>
<li><p><strong>Simplification</strong>: Focus on simplicity by removing
unnecessary elements. Use <code>theme_iom(void =TRUE)</code> to simplify
the chart’s appearance.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="divisible-content">Divisible Content<a class="anchor" aria-label="anchor" href="#divisible-content"></a>
</h3>
<p>When designing a chart, you can apply a “<strong>divisible content
strategy</strong>”. The idea is to create micro-content: aka a detailed,
re-usable and data-rich chart that extract key insights highlight data
points within a single visual. The chart should be designed to support a
single-messaging focus that should be clearly stated within your chart
title and potentially reinforced through annotations within your
chart.</p>
<p>Such focused visuals can then be easily copy-pasted or embedded in
different media: reports, presentation, talking points, websites or
social media… This approach maximizes the value of your content by
allowing you to reach different audiences with tailored messages while
maintaining a consistent brand voice.</p>
<p>This gives “<em>More Content With Less Work</em>”: not only, it
enhances your content’s reach but it also ensures that your audience can
engage with the information in various formats and platforms.</p>
</div>
<div class="section level3">
<h3 id="use-ai">Use AI!<a class="anchor" aria-label="anchor" href="#use-ai"></a>
</h3>
<p>Note that when designing a chart, you can always speed up your work
<strong>using an AI Language Model</strong> like <a href="http://copilot.microsoft.com" class="external-link">Copilot</a>. What you need is to
write your prompt, asking for an R ‘{tidyverse}’ script, defining the
type of chart you want and with a precise description of your dataset -
including the name of your dataframe and the name of its variable. Once
you have the initial script then just apply the <code>theme_iom</code>
function.</p>
</div>
</div>
<div class="section level2">
<h2 id="initial-setup">Initial Setup<a class="anchor" aria-label="anchor" href="#initial-setup"></a>
</h2>
<p>You will need to first install <a href="https://www.r-project.org/" class="external-link">R</a> and <a href="https://www.rstudio.com/products/rstudio/download/" class="external-link">R sudio</a>.
Alternatively you may also use <a href="https://code.visualstudio.com/docs/languages/r" class="external-link">Visual
Studio</a>.</p>
<p>Before we start creating IOM branded charts, make sure you have the
<strong>necessary packages installed</strong> for this tutorial. Paste
the following within your Rstudio Console:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install CRAN packages</span></span>
<span><span class="va">packages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="co"># A collection of R packages designed for data science, </span></span>
<span>  <span class="co">#including ggplot2, dplyr, tidyr, readr, purrr, tibble, stringr, and forcats.</span></span>
<span>  <span class="st">"tidyverse"</span>, </span>
<span>  <span class="co"># Provides tools for scaling data and formatting axes and legends in ggplot2.</span></span>
<span>              <span class="st">"scales"</span>, </span>
<span>  <span class="co"># Extends ggplot2 to provide better label placement, avoiding overlaps.</span></span>
<span>              <span class="st">"ggrepel"</span>,</span>
<span>  <span class="co"># Converts country names and codes between different formats.</span></span>
<span>              <span class="st">"countrycode"</span>,</span>
<span>  <span class="co"># Provides access to World Bank data &amp; World Development Indicators.</span></span>
<span>              <span class="st">"WDI"</span>, </span>
<span>  <span class="co"># Converts statistical analysis objects from R into tidy data frames.</span></span>
<span>              <span class="st">"broom"</span>,</span>
<span>  <span class="co"># A graphics device for R that produces high-quality, anti-aliased output.</span></span>
<span>              <span class="st">"ragg"</span>, </span>
<span>  <span class="co"># A package manager for R that makes it easier to install and manage packages.</span></span>
<span>              <span class="st">"pak"</span>,</span>
<span>  <span class="co"># Provides support for a standardized way to encode spatial vector data.</span></span>
<span>              <span class="st">"sf"</span>, </span>
<span>  <span class="co"># Provides access to Natural Earth map data.</span></span>
<span>              <span class="st">"rnaturalearth"</span>, </span>
<span>  <span class="co"># Contains the actual data for the rnaturalearth package.</span></span>
<span>              <span class="st">"rnaturalearthdata"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">packages</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install iomthemes with pak</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pkg_install.html" class="external-link">pkg_install</a></span><span class="op">(</span><span class="st">"iom/iomthemes"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Load the packages</strong> into your R environment:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/iom/iomthemes" class="external-link">iomthemes</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">#&gt;   object 'type_sum.accel' not found</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vincentarelbundock.github.io/countrycode/" class="external-link">countrycode</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vincentarelbundock.github.io/WDI/" class="external-link">WDI</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggrepel.slowkow.com/" class="external-link">ggrepel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rnaturalearth/" class="external-link">rnaturalearth</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rnaturalearthdata/" class="external-link">rnaturalearthdata</a></span><span class="op">)</span></span></code></pre></div>
<p>Some packages installed above will be loaded using the
<code>::</code> notation to make the code and intentions clearer.</p>
</div>
<div class="section level2">
<h2 id="demo-data">Demo Data<a class="anchor" aria-label="anchor" href="#demo-data"></a>
</h2>
<p>In this tutorial, to make it relevant to IOM context, we’ll use the
<a href="https://www.un.org/development/desa/pd/content/international-migrant-stock" class="external-link">Statistics
on Global Migration</a> provided by the Population Division of United
Nations Department of Economic and Social Affairs (UNDESA).</p>
<p>The estimates of the number (or “stock”) of international migrants
disaggregated by age, sex and country or area of origin are based on
national statistics, in most cases obtained from population censuses.
Additionally, population registers and nationally representative surveys
provided information on the number and composition of international
migrants.</p>
<p>The dataset presents estimates of international migrant by age, sex
and origin. Estimates are presented for 1990, 1995, 2000, 2005, 2010,
2015 and 2020 and are available for 232 countries and areas of the
world. The estimates are based on official statistics on the
foreign-born or the foreign population.</p>
<p>Those dataset are conveniently directly included in the package. In
the script below, you can also learn about some basic data preparation
steps when loading data from Excel.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># turn-off scientific notation like 1e+48</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">999</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">## The files are within the 'inst' - installation folder of the package</span></span>
<span><span class="va">file.sex.destination.origin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"undesa_pd_2020_ims_stock_by_sex_destination_and_origin.xlsx"</span>,</span>
<span>                                           package <span class="op">=</span> <span class="st">"iomthemes"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data.sex.destination.origin</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">file.sex.destination.origin</span>,</span>
<span>  col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"numeric"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>,<span class="st">"numeric"</span>, <span class="st">"text"</span>,</span>
<span>                <span class="st">"text"</span>, <span class="st">"numeric"</span>,</span>
<span>                <span class="st">"numeric"</span>,<span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,</span>
<span>                <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, </span>
<span>                <span class="st">"numeric"</span>,<span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>,</span>
<span>                <span class="st">"numeric"</span>,<span class="st">"numeric"</span>, <span class="st">"numeric"</span> <span class="op">)</span>, </span>
<span>                                          sheet <span class="op">=</span> <span class="st">"Table 1"</span>, skip <span class="op">=</span> <span class="fl">9</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co">## Getting clean variable names</span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co">## Renaming correctly the variables - let's get the variable names we have</span></span>
<span>  <span class="co"># dput(names(data.sex.destination.origin))</span></span>
<span>  <span class="co">## List of variable we can keep</span></span>
<span>  <span class="co">#  "index", </span></span>
<span>  <span class="co"># "region_development_group_country_or_area_of_destination", </span></span>
<span>  <span class="co"># "notes_of_destination",</span></span>
<span>  <span class="co"># "location_code_of_destination",</span></span>
<span>  <span class="co"># "type_of_data_of_destination", </span></span>
<span>  <span class="co"># "region_development_group_country_or_area_of_origin",</span></span>
<span>  <span class="co"># "location_code_of_origin"</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>    <span class="co">## Both Sex</span></span>
<span>    <span class="st">"total.1990"</span><span class="op">=</span><span class="st">"x1990_8"</span>, <span class="st">"total.1995"</span><span class="op">=</span><span class="st">"x1995_9"</span>,</span>
<span>    <span class="st">"total.2000"</span><span class="op">=</span> <span class="st">"x2000_10"</span>, <span class="st">"total.2005"</span><span class="op">=</span><span class="st">"x2005_11"</span>,</span>
<span>    <span class="st">"total.2010"</span><span class="op">=</span><span class="st">"x2010_12"</span>, <span class="st">"total.2015"</span><span class="op">=</span><span class="st">"x2015_13"</span>,</span>
<span>    <span class="st">"total.2020"</span><span class="op">=</span><span class="st">"x2020_14"</span>,</span>
<span>    <span class="co">## Male</span></span>
<span>    <span class="st">"male.1990"</span><span class="op">=</span><span class="st">"x1990_15"</span>, <span class="st">"male.1995"</span><span class="op">=</span><span class="st">"x1995_16"</span>,</span>
<span>    <span class="st">"male.2000"</span><span class="op">=</span><span class="st">"x2000_17"</span>, <span class="st">"male.2005"</span><span class="op">=</span><span class="st">"x2005_18"</span>,</span>
<span>    <span class="st">"male.2010"</span><span class="op">=</span><span class="st">"x2010_19"</span>, <span class="st">"male.2015"</span><span class="op">=</span><span class="st">"x2015_20"</span>,</span>
<span>    <span class="st">"male.2020"</span><span class="op">=</span><span class="st">"x2020_21"</span>,</span>
<span>    <span class="co">## Male</span></span>
<span>    <span class="st">"female.1990"</span><span class="op">=</span><span class="st">"x1990_22"</span>, <span class="st">"female.1995"</span><span class="op">=</span><span class="st">"x1995_23"</span>,</span>
<span>    <span class="st">"female.2000"</span><span class="op">=</span><span class="st">"x2000_24"</span>, <span class="st">"female.2005"</span><span class="op">=</span><span class="st">"x2005_25"</span>,</span>
<span>    <span class="st">"female.2010"</span><span class="op">=</span><span class="st">"x2010_26"</span>, <span class="st">"female.2015"</span><span class="op">=</span><span class="st">"x2015_27"</span>,</span>
<span>    <span class="st">"female.2020"</span><span class="op">=</span><span class="st">"x2020_28"</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="co"># Add ISO2 country code to identify the country level records and</span></span>
<span>  <span class="co"># have a key to join for mapping purpose</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> origin.iso2 <span class="op">=</span> <span class="fu">countrycode</span><span class="fu">::</span><span class="fu"><a href="https://vincentarelbundock.github.io/countrycode/reference/countrycode.html" class="external-link">countrycode</a></span><span class="op">(</span></span>
<span>    <span class="va">location_code_of_origin</span>,</span>
<span>    origin <span class="op">=</span> <span class="st">"un"</span>,</span>
<span>    destination <span class="op">=</span> <span class="st">"iso2c"</span><span class="op">)</span>,</span>
<span>    destination.iso2 <span class="op">=</span> <span class="fu">countrycode</span><span class="fu">::</span><span class="fu"><a href="https://vincentarelbundock.github.io/countrycode/reference/countrycode.html" class="external-link">countrycode</a></span><span class="op">(</span></span>
<span>      <span class="va">location_code_of_destination</span>,</span>
<span>      origin <span class="op">=</span> <span class="st">"un"</span>,</span>
<span>      destination <span class="op">=</span> <span class="st">"iso2c"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## The second key file from UNDESA</span></span>
<span><span class="va">file.age.sex.destination</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"undesa_pd_2020_ims_stock_by_age_sex_and_destination.xlsx"</span>,</span>
<span>                                        package <span class="op">=</span> <span class="st">"iomthemes"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Age &amp; Sex breakdown for migrants</span></span>
<span><span class="va">data.age.sex.destination.mig</span> <span class="op">&lt;-</span>   <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">file.age.sex.destination</span>,</span>
<span>                                                sheet <span class="op">=</span> <span class="st">"Table 1"</span>, skip <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="co">## Getting clean variable names</span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="co">## Renaming correctly the variables</span></span>
<span>  <span class="co"># dput(names(data.age.sex.destination.mig))</span></span>
<span>  <span class="co">#   "index", "year", "region_development_group_country_or_area", </span></span>
<span>  <span class="co"># "notes", "location_code", "type_of_data",</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>    <span class="co">## Both Sex</span></span>
<span>    <span class="st">"total.age.0_4"</span><span class="op">=</span><span class="st">"x0_4_7"</span>, <span class="st">"total.age.5_9"</span><span class="op">=</span><span class="st">"x5_9_8"</span>,</span>
<span>    <span class="st">"total.age.10_14"</span><span class="op">=</span><span class="st">"x10_14_9"</span>, <span class="st">"total.15_19"</span><span class="op">=</span><span class="st">"x15_19_10"</span>,</span>
<span>    <span class="st">"total.age.20_24"</span><span class="op">=</span><span class="st">"x20_24_11"</span>, <span class="st">"total.age.25_29"</span><span class="op">=</span><span class="st">"x25_29_12"</span>,</span>
<span>    <span class="st">"total.age.30_34"</span><span class="op">=</span><span class="st">"x30_34_13"</span>, <span class="st">"total.age.35_39"</span><span class="op">=</span> <span class="st">"x35_39_14"</span>,</span>
<span>    <span class="st">"total.age.40_44"</span><span class="op">=</span><span class="st">"x40_44_15"</span>, <span class="st">"total.age.45_49"</span><span class="op">=</span><span class="st">"x45_49_16"</span>,</span>
<span>    <span class="st">"total.age.50_54"</span><span class="op">=</span><span class="st">"x50_54_17"</span>, <span class="st">"total.age.55_59"</span><span class="op">=</span><span class="st">"x55_59_18"</span>,</span>
<span>    <span class="st">"total.age.60_64"</span><span class="op">=</span><span class="st">"x60_64_19"</span>, <span class="st">"total.age.65_69"</span><span class="op">=</span><span class="st">"x65_69_20"</span>,</span>
<span>    <span class="st">"total.age.70_74"</span><span class="op">=</span><span class="st">"x70_74_21"</span>, <span class="st">"total.age.75"</span><span class="op">=</span><span class="st">"x75_22"</span>,</span>
<span>    <span class="st">"total.age.all"</span><span class="op">=</span><span class="st">"total_23"</span>,</span>
<span>    </span>
<span>    <span class="co">## Male</span></span>
<span>    <span class="st">"male.age.0_4"</span><span class="op">=</span><span class="st">"x0_4_24"</span>,<span class="st">"male.age.5_9"</span><span class="op">=</span> <span class="st">"x5_9_25"</span>,</span>
<span>    <span class="st">"male.age.10_14"</span><span class="op">=</span><span class="st">"x10_14_26"</span>,<span class="st">"male.age.15_19"</span><span class="op">=</span> <span class="st">"x15_19_27"</span>,</span>
<span>    <span class="st">"male.age.20_24"</span><span class="op">=</span><span class="st">"x20_24_28"</span>, <span class="st">"male.age.25_29"</span><span class="op">=</span> <span class="st">"x25_29_29"</span>,</span>
<span>    <span class="st">"male.age.30_34"</span><span class="op">=</span><span class="st">"x30_34_30"</span>, <span class="st">"male.age.35_39"</span><span class="op">=</span><span class="st">"x35_39_31"</span>,</span>
<span>    <span class="st">"male.age.40_44"</span><span class="op">=</span><span class="st">"x40_44_32"</span>, <span class="st">"male.age.45_49"</span><span class="op">=</span><span class="st">"x45_49_33"</span>,</span>
<span>    <span class="st">"male.age.50_54"</span><span class="op">=</span><span class="st">"x50_54_34"</span>,<span class="st">"male.age.55_59"</span><span class="op">=</span><span class="st">"x55_59_35"</span>,</span>
<span>    <span class="st">"male.age.60_64"</span><span class="op">=</span><span class="st">"x60_64_36"</span>, <span class="st">"male.age.65_69"</span><span class="op">=</span><span class="st">"x65_69_37"</span>,</span>
<span>    <span class="st">"male.age.70_74"</span><span class="op">=</span><span class="st">"x70_74_38"</span>,<span class="st">"male.age.75"</span><span class="op">=</span><span class="st">"x75_39"</span>,</span>
<span>    <span class="st">"male.age.all"</span><span class="op">=</span><span class="st">"total_40"</span>,</span>
<span>    </span>
<span>    <span class="co">## Female</span></span>
<span>    <span class="st">"female.age.0_4"</span><span class="op">=</span><span class="st">"x0_4_41"</span>,<span class="st">"female.age.5_9"</span><span class="op">=</span> <span class="st">"x5_9_42"</span>,</span>
<span>    <span class="st">"female.age.10_14"</span><span class="op">=</span><span class="st">"x10_14_43"</span>,<span class="st">"female.age.15_19"</span><span class="op">=</span> <span class="st">"x15_19_44"</span>,</span>
<span>    <span class="st">"female.age.20_24"</span><span class="op">=</span><span class="st">"x20_24_45"</span>, <span class="st">"female.age.25_29"</span><span class="op">=</span><span class="st">"x25_29_46"</span>,</span>
<span>    <span class="st">"female.age.30_34"</span><span class="op">=</span><span class="st">"x30_34_47"</span>, <span class="st">"female.age.35_39"</span><span class="op">=</span> <span class="st">"x35_39_48"</span>,</span>
<span>    <span class="st">"female.age.40_44"</span><span class="op">=</span><span class="st">"x40_44_49"</span>, <span class="st">"female.age.45_49"</span><span class="op">=</span> <span class="st">"x45_49_50"</span>,</span>
<span>    <span class="st">"female.age.50_54"</span><span class="op">=</span><span class="st">"x50_54_51"</span>, <span class="st">"female.age.55_59"</span><span class="op">=</span><span class="st">"x55_59_52"</span>,</span>
<span>    <span class="st">"female.age.60_64"</span><span class="op">=</span><span class="st">"x60_64_53"</span>, <span class="st">"female.age.65_69"</span><span class="op">=</span><span class="st">"x65_69_54"</span>,</span>
<span>    <span class="st">"female.age.70_74"</span><span class="op">=</span><span class="st">"x70_74_55"</span>,<span class="st">"female.age.75"</span><span class="op">=</span> <span class="st">"x75_56"</span>,</span>
<span>    <span class="st">"female.age.all"</span><span class="op">=</span><span class="st">"total_57"</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="co">## Provide legible labels for Data Source</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span> <span class="op">(</span> type_data_label <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">type_of_data</span>,</span>
<span>   <span class="st">"B"</span> <span class="op">=</span> <span class="st">"Estimates Derived from data on the foreign-born population"</span>  ,</span>
<span>   <span class="st">"B R"</span> <span class="op">=</span> <span class="st">"Estimates Derived from data on the foreign-born population + </span></span>
<span><span class="st">            Forced Displacement/UNHCR"</span>,</span>
<span>   <span class="st">"C"</span> <span class="op">=</span> <span class="st">"Estimates Derived from data on foreign citizens"</span>,</span>
<span>   <span class="st">"C B R"</span> <span class="op">=</span> <span class="st">"EstimatesDerived from data on the foreign-born population &amp;</span></span>
<span><span class="st">              on foreign citizens + Forced Displacement/UNHCR"</span>  ,</span>
<span>   <span class="st">"C R"</span>  <span class="op">=</span> <span class="st">"Estimates Derived from data on foreign citizens + </span></span>
<span><span class="st">             Forced Displacement/UNHCR"</span>  ,</span>
<span>   <span class="st">"I"</span>  <span class="op">=</span> <span class="st">"Inputed Estimates"</span>  ,</span>
<span>   <span class="st">"I R"</span> <span class="op">=</span><span class="st">"Inputed Estimates + Forced Displacement/UNHCR"</span>  <span class="op">)</span>,  </span>
<span>                  destination.iso2 <span class="op">=</span> <span class="fu">countrycode</span><span class="fu">::</span><span class="fu"><a href="https://vincentarelbundock.github.io/countrycode/reference/countrycode.html" class="external-link">countrycode</a></span><span class="op">(</span></span>
<span>                    <span class="va">location_code</span>,</span>
<span>                    origin <span class="op">=</span> <span class="st">"un"</span>,</span>
<span>                    destination <span class="op">=</span> <span class="st">"iso2c"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Age &amp; Sex breakdown for local population</span></span>
<span><span class="va">data.age.sex.destination.loc</span> <span class="op">&lt;-</span>   <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">file.age.sex.destination</span>,</span>
<span>                                              sheet <span class="op">=</span> <span class="st">"Table 2"</span>, skip <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="co">## Getting clean variable names</span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="co">## Renaming correctly the variables</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>    <span class="co">## Both Sex</span></span>
<span>    <span class="st">"total.age.0_4"</span><span class="op">=</span><span class="st">"x0_4_7"</span>, <span class="st">"total.age.5_9"</span><span class="op">=</span><span class="st">"x5_9_8"</span>,</span>
<span>    <span class="st">"total.age.10_14"</span><span class="op">=</span><span class="st">"x10_14_9"</span>, <span class="st">"total.15_19"</span><span class="op">=</span><span class="st">"x15_19_10"</span>,</span>
<span>    <span class="st">"total.age.20_24"</span><span class="op">=</span><span class="st">"x20_24_11"</span>, <span class="st">"total.age.25_29"</span><span class="op">=</span><span class="st">"x25_29_12"</span>,</span>
<span>    <span class="st">"total.age.30_34"</span><span class="op">=</span><span class="st">"x30_34_13"</span>, <span class="st">"total.age.35_39"</span><span class="op">=</span> <span class="st">"x35_39_14"</span>,</span>
<span>    <span class="st">"total.age.40_44"</span><span class="op">=</span><span class="st">"x40_44_15"</span>, <span class="st">"total.age.45_49"</span><span class="op">=</span><span class="st">"x45_49_16"</span>,</span>
<span>    <span class="st">"total.age.50_54"</span><span class="op">=</span><span class="st">"x50_54_17"</span>, <span class="st">"total.age.55_59"</span><span class="op">=</span><span class="st">"x55_59_18"</span>,</span>
<span>    <span class="st">"total.age.60_64"</span><span class="op">=</span><span class="st">"x60_64_19"</span>, <span class="st">"total.age.65_69"</span><span class="op">=</span><span class="st">"x65_69_20"</span>,</span>
<span>    <span class="st">"total.age.70_74"</span><span class="op">=</span><span class="st">"x70_74_21"</span>, <span class="st">"total.age.75"</span><span class="op">=</span><span class="st">"x75_22"</span>,</span>
<span>    <span class="st">"total.age.all"</span><span class="op">=</span><span class="st">"total_23"</span>,</span>
<span>    </span>
<span>    <span class="co">## Male</span></span>
<span>    <span class="st">"male.age.0_4"</span><span class="op">=</span><span class="st">"x0_4_24"</span>,<span class="st">"male.age.5_9"</span><span class="op">=</span> <span class="st">"x5_9_25"</span>,</span>
<span>    <span class="st">"male.age.10_14"</span><span class="op">=</span><span class="st">"x10_14_26"</span>,<span class="st">"male.age.15_19"</span><span class="op">=</span> <span class="st">"x15_19_27"</span>,</span>
<span>    <span class="st">"male.age.20_24"</span><span class="op">=</span><span class="st">"x20_24_28"</span>, <span class="st">"male.age.25_29"</span><span class="op">=</span> <span class="st">"x25_29_29"</span>,</span>
<span>    <span class="st">"male.age.30_34"</span><span class="op">=</span><span class="st">"x30_34_30"</span>, <span class="st">"male.age.35_39"</span><span class="op">=</span><span class="st">"x35_39_31"</span>,</span>
<span>    <span class="st">"male.age.40_44"</span><span class="op">=</span><span class="st">"x40_44_32"</span>, <span class="st">"male.age.45_49"</span><span class="op">=</span><span class="st">"x45_49_33"</span>,</span>
<span>    <span class="st">"male.age.50_54"</span><span class="op">=</span><span class="st">"x50_54_34"</span>,<span class="st">"male.age.55_59"</span><span class="op">=</span><span class="st">"x55_59_35"</span>,</span>
<span>    <span class="st">"male.age.60_64"</span><span class="op">=</span><span class="st">"x60_64_36"</span>, <span class="st">"male.age.65_69"</span><span class="op">=</span><span class="st">"x65_69_37"</span>,</span>
<span>    <span class="st">"male.age.70_74"</span><span class="op">=</span><span class="st">"x70_74_38"</span>,<span class="st">"male.age.75"</span><span class="op">=</span><span class="st">"x75_39"</span>,</span>
<span>    <span class="st">"male.age.all"</span><span class="op">=</span><span class="st">"total_40"</span>,</span>
<span>    </span>
<span>    <span class="co">## Female</span></span>
<span>    <span class="st">"female.age.0_4"</span><span class="op">=</span><span class="st">"x0_4_41"</span>,<span class="st">"female.age.5_9"</span><span class="op">=</span> <span class="st">"x5_9_42"</span>,</span>
<span>    <span class="st">"female.age.10_14"</span><span class="op">=</span><span class="st">"x10_14_43"</span>,<span class="st">"female.age.15_19"</span><span class="op">=</span> <span class="st">"x15_19_44"</span>,</span>
<span>    <span class="st">"female.age.20_24"</span><span class="op">=</span><span class="st">"x20_24_45"</span>, <span class="st">"female.age.25_29"</span><span class="op">=</span><span class="st">"x25_29_46"</span>,</span>
<span>    <span class="st">"female.age.30_34"</span><span class="op">=</span><span class="st">"x30_34_47"</span>, <span class="st">"female.age.35_39"</span><span class="op">=</span> <span class="st">"x35_39_48"</span>,</span>
<span>    <span class="st">"female.age.40_44"</span><span class="op">=</span><span class="st">"x40_44_49"</span>, <span class="st">"female.age.45_49"</span><span class="op">=</span> <span class="st">"x45_49_50"</span>,</span>
<span>    <span class="st">"female.age.50_54"</span><span class="op">=</span><span class="st">"x50_54_51"</span>, <span class="st">"female.age.55_59"</span><span class="op">=</span><span class="st">"x55_59_52"</span>,</span>
<span>    <span class="st">"female.age.60_64"</span><span class="op">=</span><span class="st">"x60_64_53"</span>, <span class="st">"female.age.65_69"</span><span class="op">=</span><span class="st">"x65_69_54"</span>,</span>
<span>    <span class="st">"female.age.70_74"</span><span class="op">=</span><span class="st">"x70_74_55"</span>,<span class="st">"female.age.75"</span><span class="op">=</span> <span class="st">"x75_56"</span>,</span>
<span>    <span class="st">"female.age.all"</span><span class="op">=</span><span class="st">"total_57"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co">## Provide legible labels for Data Source</span></span>
<span>  <span class="co">## Provide legible labels for Data Source</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span> <span class="op">(</span> type_data_label <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">type_of_data</span>,</span>
<span>   <span class="st">"B"</span> <span class="op">=</span> <span class="st">"Estimates Derived from data on the foreign-born population"</span>  ,</span>
<span>   <span class="st">"B R"</span> <span class="op">=</span> <span class="st">"Estimates Derived from data on the foreign-born population + </span></span>
<span><span class="st">            Forced Displacement/UNHCR"</span>,</span>
<span>   <span class="st">"C"</span> <span class="op">=</span> <span class="st">"Estimates Derived from data on foreign citizens"</span>,</span>
<span>   <span class="st">"C B R"</span> <span class="op">=</span> <span class="st">"EstimatesDerived from data on the foreign-born population &amp;</span></span>
<span><span class="st">             on foreign citizens + Forced Displacement/UNHCR"</span>  ,</span>
<span>   <span class="st">"C R"</span>  <span class="op">=</span> <span class="st">"Estimates Derived from data on foreign citizens + </span></span>
<span><span class="st">             Forced Displacement/UNHCR"</span>  ,</span>
<span>   <span class="st">"I"</span>  <span class="op">=</span> <span class="st">"Inputed Estimates"</span>  ,</span>
<span>   <span class="st">"I R"</span> <span class="op">=</span><span class="st">"Inputed Estimates + Forced Displacement/UNHCR"</span>  <span class="op">)</span>,    </span>
<span>                  destination.iso2 <span class="op">=</span> <span class="fu">countrycode</span><span class="fu">::</span><span class="fu"><a href="https://vincentarelbundock.github.io/countrycode/reference/countrycode.html" class="external-link">countrycode</a></span><span class="op">(</span></span>
<span>                    <span class="va">location_code</span>,</span>
<span>                    origin <span class="op">=</span> <span class="st">"un"</span>,</span>
<span>                    destination <span class="op">=</span> <span class="st">"iso2c"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Set the caption we will use for attribution for all charts below</span></span>
<span><span class="va">caption</span> <span class="op">&lt;-</span> <span class="st">"Source: United Nations Department of Economic and Social Affairs,</span></span>
<span><span class="st">            Population Division. International Migrant Stock (2020)"</span></span></code></pre></div>
<p>To demonstrate line charts usage, we will use data on <a href="https://www.worldbank.org/en/topic/migration/brief/remittances-knomad" class="external-link">global
remittance</a> leveraging a dedicated package <a href="http://vincentarelbundock.github.io/WDI/" class="external-link">WPI</a> to work directly
through the <a href="https://data.worldbank.org/indicator?tab=all" class="external-link">World
Bank Inidcators Data API</a></p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>Below you will find a collection of charts that will hopefully
inspire you. You will find a series of practical tips to implement
design and data story telling techniques. You should actually be able to
adjust each of the plots below to your context by just selecting
different initial filters on the data and re-adjust them.</p>
<p>The script below are implemented using a coding style that leverage
the <a href="https://www.tidyverse.org/" class="external-link">{tidyverse}</a>.</p>
<div class="section level3">
<h3 id="bar-chart">Bar chart<a class="anchor" aria-label="anchor" href="#bar-chart"></a>
</h3>
<p>Some key points to consider when designing bar chart are:</p>
<ul>
<li><p>Start at the zero baseline! No exception. Do not clip the axis in
order to highlight disparities at the top of the axis. Instead, try
recalculating your data as percentages, or try another type of
chart;</p></li>
<li><p>Ensure numerical axis labels are aligned to the decimal
point;</p></li>
<li><p>Clearly denote currency or units;</p></li>
<li><p>When axis lines are present, it is not necessary to label each
data value. However, it can be useful to highlight the final value or
other important data points.</p></li>
<li><p>Convert your data to rounded, easily digestible values for chart
labeling</p></li>
<li><p>Omit axes and baselines when data values are labeled, simpler,
better!</p></li>
<li><p>When the range of your data crosses natural numerical milestones,
such as from millions to billions, set the entire chart in the larger
milestone. A chart should never reflect more than 1,000 millions.
etc.</p></li>
<li><p>Ensure labels fit neatly under the bars in no more than two
lines.</p></li>
<li><p>Horizontal bar charts help compare long lists of values or
categories. It has the advantage of printing long labels without using
two lines or printing vertical text, as would be required for a vertical
bar.</p></li>
<li><p>Remember to sort your data before charting so that readers can
easily compare.</p></li>
<li><p>Labeled values eliminate the need for grid lines, while rounding
is done to make the values easy to digest.</p></li>
<li><p>Don’t use 3D effect!</p></li>
</ul>
<p>Note that by default, R will display your data in alphabetical order,
but arranging it by size instead is simple: just wrap
<code><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder()</a></code> around the <code>x</code> or <code>y</code>
variable you want to rearrange, and specify which variable you want to
reorder it by.</p>
<p>E.g. <code>x = reorder(Country, Value2)</code>. Ascending order is
the default, but you can change it to descending by wrapping
<code><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc()</a></code> around the variable you’re ordering by.</p>
<div class="section level4">
<h4 id="single-bar-chart">Single bar chart<a class="anchor" aria-label="anchor" href="#single-bar-chart"></a>
</h4>
<p>Let’s start by creating a simple bar chart to visualize the top 10
countries of origin of migrants.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data.sex.destination.origin</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Filter out rows where 'origin.iso2' and 'origin.iso2' is NA (missing)</span></span>
<span>  <span class="co"># We do so to keep only country level records - filter out region subtotal</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">origin.iso2</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">destination.iso2</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Group the data by country of origin</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_origin</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Summarize the total number of migrants for the year 2020 &amp; remove NA! </span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total_migrants_2020 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total.2020</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Arrange the summarized data in descending order of total migrants</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">total_migrants_2020</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Select the top 10 countries of origin with the highest number of migrants</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>  </span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_origin</span>,</span>
<span>                         <span class="va">total_migrants_2020</span><span class="op">)</span>,</span>
<span>             y <span class="op">=</span> <span class="va">total_migrants_2020</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Define it as a bar chart and apply IOM color palette</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>           fill <span class="op">=</span> <span class="fu"><a href="../reference/iom_pal.html">iom_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span>,</span>
<span>           width <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Flip the chart to make it more legible</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="co">## Format the labels for the x axis</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span>     <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Main Countries of Migrant Origin"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Highlighting the top 10 countries contributing to global</span></span>
<span><span class="st">                migration | 2020"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Country of Origin"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Total Migrants (2020)"</span>,</span>
<span>       caption <span class="op">=</span> <span class="va">caption</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## and apply IOM theme</span></span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"X"</span>, axis <span class="op">=</span> <span class="st">"Y"</span>, axis_title <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/bar-plot-1.png" width="100%"></p>
<p><strong>Plot with labels:</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot with labels</span></span>
<span><span class="co"># We start from the previous plot and adjust it...</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> </span>
<span>  <span class="co">## Add labels within the chart - we format the labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span></span>
<span>      scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      accuracy <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">(</span><span class="va">total_migrants_2020</span><span class="op">)</span>  <span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="op">-</span><span class="fl">.2</span> <span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="co"># and apply the theme again</span></span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="cn">FALSE</span>, axis <span class="op">=</span> <span class="st">"Y"</span>, axis_text <span class="op">=</span> <span class="st">"Y"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># here is the revised plot p1!</span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/bar-label-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="grouped-bar-chart">Grouped bar chart<a class="anchor" aria-label="anchor" href="#grouped-bar-chart"></a>
</h4>
<p>Making a grouped bar chart is very similar to making a bar chart.</p>
<p>You just need to change <code>position = "identity"</code> to
<code>position = "dodge"</code>, and set the <code>fill</code>
aesthetically instead.</p>
<p>Let’s compare migrant population originating in different region over
time. We will use a grouped bar chart.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data.sex.destination.origin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_destination</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AFRICA"</span>, <span class="st">"ASIA"</span>, <span class="st">"EUROPE"</span>, </span>
<span>             <span class="st">"LATIN AMERICA AND THE CARIBBEAN"</span>,</span>
<span>             <span class="st">"NORTHERN AMERICA"</span>, <span class="st">"OCEANIA"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_origin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WORLD"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"year"</span>, value <span class="op">=</span> <span class="st">"total_migrants"</span>, <span class="va">total.2015</span><span class="op">:</span><span class="va">total.2020</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"total."</span>, <span class="st">""</span>, <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Sometimes you need to order your data in a way that isn't alphabetical </span></span>
<span><span class="co"># or reordered by size. </span></span>
<span><span class="co"># To order these correctly you need to set your data factor levels</span></span>
<span><span class="co"># before making the plot.</span></span>
<span><span class="co"># Specify the order you want the categories to be plotted in the </span></span>
<span><span class="co"># `levels` argument:</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">region_development_group_country_or_area_of_destination</span>,</span>
<span>              y <span class="op">=</span> <span class="va">total_migrants</span>,</span>
<span>              fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>  width <span class="op">=</span> <span class="fl">.7</span>,</span>
<span>             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/iom_scale.html">scale_fill_iom_d</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## Define the plot title formatted so the color reflects the legend</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>         <span class="st">"Migrant Population Growth by Region: &lt;span style='color:"</span>,</span>
<span>         <span class="fu"><a href="../reference/iom_pal.html">iom_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2</span>, <span class="st">"pal_blue"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>         <span class="st">"'&gt;2015&lt;/span&gt; and &lt;span style='color:"</span>,</span>
<span>         <span class="fu"><a href="../reference/iom_pal.html">iom_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2</span>, <span class="st">"pal_blue"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>         <span class="st">"'&gt;2020&lt;/span&gt; by Region of Destination"</span> <span class="op">)</span>,</span>
<span>       subtitle<span class="op">=</span> <span class="st">"Analyzing changes in migrant populations across</span></span>
<span><span class="st">                  different regions over five years"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">""</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Destination Region"</span>,</span>
<span>       caption <span class="op">=</span> <span class="va">caption</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span></span>
<span>    grid <span class="op">=</span> <span class="st">"X"</span>, axis <span class="op">=</span> <span class="st">"Y"</span>, axis_title <span class="op">=</span> <span class="st">"X"</span>,</span>
<span>    legend <span class="op">=</span> <span class="cn">FALSE</span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/group-bar-plot-1.png" width="100%"></p>
<p><strong>Plot with labels:</strong></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="co">## let's expand scales to add the labels at the right side of the plot</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.2</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span></span>
<span>      scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      accuracy <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">(</span><span class="va">total_migrants</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>  hjust <span class="op">=</span> <span class="op">-</span><span class="fl">.2</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span> <span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="co"># apply IOM theme</span></span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>            axis <span class="op">=</span> <span class="st">"Y"</span>, </span>
<span>            axis_text <span class="op">=</span> <span class="st">"Y"</span>, </span>
<span>            axis_title <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>            legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/group-bar-label-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="stacked-bar-chart">Stacked bar chart<a class="anchor" aria-label="anchor" href="#stacked-bar-chart"></a>
</h4>
<p>Let’s make a stacked bar chart comparing the top 10 countries of
destination, by region of Origin, in 2020.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data.sex.destination.origin</span><span class="op">|&gt;</span></span>
<span><span class="co"># Filter data for the specified regions of origin and year 2020</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_origin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AFRICA"</span>, <span class="st">"ASIA"</span>, <span class="st">"EUROPE"</span>, </span>
<span>             <span class="st">"LATIN AMERICA AND THE CARIBBEAN"</span>, </span>
<span>             <span class="st">"NORTHERN AMERICA"</span>, <span class="st">"OCEANIA"</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">destination.iso2</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="co"># Group by destination country and region of origin and sum the total migrants</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_destination</span>, </span>
<span>           <span class="va">region_development_group_country_or_area_of_origin</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total_migrants_2020 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total.2020</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Get the top 10 countries of destination</span></span>
<span><span class="va">top_10_destinations</span> <span class="op">&lt;-</span> <span class="va">data</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_destination</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total_migrants <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total_migrants_2020</span><span class="op">)</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">total_migrants</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_destination</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter the grouped data for the top 10 destinations</span></span>
<span><span class="va">top_10_data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_destination</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>          <span class="va">top_10_destinations</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The value passed to the `position` argument will determine if </span></span>
<span><span class="co"># your stacked chart shows proportions or actual values. </span></span>
<span></span>
<span><span class="co">#`position = "fill"` will draw your stacks as proportions,</span></span>
<span><span class="co"># and `position = "identity"` will draw number values. </span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">top_10_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_destination</span>, </span>
<span>                                    <span class="va">total_migrants_2020</span><span class="op">)</span>, </span>
<span>        y <span class="op">=</span> <span class="va">total_migrants_2020</span>, </span>
<span>        fill <span class="op">=</span> <span class="va">region_development_group_country_or_area_of_origin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Major Destinations for Migrants"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Categorized by region of origin | 2020"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Country of Destination"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Total Migrants"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Region of Origin"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>  labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span>   <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span>  option <span class="op">=</span><span class="st">"cividis"</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span></span>
<span>    grid <span class="op">=</span> <span class="st">"X"</span>, axis <span class="op">=</span> <span class="st">"Y"</span>, axis_title <span class="op">=</span> <span class="st">"X"</span>,</span>
<span>    legend_text_size <span class="op">=</span> <span class="fl">9</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">p</span> </span></code></pre></div>
<p><img src="iomthemes_files/figure-html/stack-bar-plot-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="population-pyramid">Population pyramid<a class="anchor" aria-label="anchor" href="#population-pyramid"></a>
</h4>
<p>This type of chart is perfect to represent age &amp; gender
disagregation. Let’s make a population pyramid of migrant populations
compared to local population in Europe in 2020.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter data for Europe and the year 2020</span></span>
<span><span class="va">migrant</span> <span class="op">&lt;-</span> <span class="va">data.age.sex.destination.mig</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="co">#region_development_group_country_or_area == "EUROPE" &amp;</span></span>
<span>           <span class="va">destination.iso2</span> <span class="op">==</span> <span class="st">"GB"</span> <span class="op">&amp;</span></span>
<span>           <span class="va">year</span> <span class="op">==</span> <span class="fl">2020</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"male.age"</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"female.age"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"age_sex"</span>, value <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">age_sex</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"age_group"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"ag"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="va">age_group</span> <span class="op">!=</span> <span class="st">"e.all"</span>  <span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>population <span class="op">=</span> <span class="st">"Migrant"</span>,</span>
<span>         count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span>,</span>
<span>         total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span>,</span>
<span>         per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">count</span> <span class="op">/</span> <span class="va">total</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">*</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Select relevant columns and gather data into long format</span></span>
<span><span class="va">local</span> <span class="op">&lt;-</span> <span class="va">data.age.sex.destination.loc</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="co">#region_development_group_country_or_area == "EUROPE" &amp;</span></span>
<span>           <span class="va">destination.iso2</span> <span class="op">==</span> <span class="st">"GB"</span> <span class="op">&amp;</span></span>
<span>           <span class="va">year</span> <span class="op">==</span> <span class="fl">2020</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"male.age"</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"female.age"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"age_sex"</span>, value <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">age_sex</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"age_group"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"ag"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="va">age_group</span> <span class="op">!=</span> <span class="st">"e.all"</span>  <span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>population <span class="op">=</span> <span class="st">"Local"</span>,</span>
<span>         count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span>,</span>
<span>         total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span>,</span>
<span>         per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">count</span> <span class="op">/</span> <span class="va">total</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">*</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine migrant and local data</span></span>
<span><span class="va">combined_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">migrant</span> , <span class="va">local</span> <span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>  <span class="co">#"e.0_4"  "e.5_9"   "e.10_14" "e.20_24" "e.25_29" "e.30_34"</span></span>
<span>  <span class="co"># "e.35_39" "e.40_44" "e.45_49"  "e.50_54"</span></span>
<span><span class="co">#"e.55_59" "e.60_64" "e.65_69" "e.70_74" "e.75"</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ageclass <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="st">"e.0_4"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"0-4"</span>,</span>
<span>                             <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="st">"e.5_9"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"5-9"</span>,</span>
<span>                             <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="st">"e.10_14"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"10-14"</span>,</span>
<span>                             <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="st">"e.15_19"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"15-19"</span>,</span>
<span>                             <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="st">"e.20_24"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"20-24"</span>,</span>
<span>                             <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="st">"e.25_29"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"25-29"</span>,</span>
<span>                             <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="st">"e.30_34"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"30-34"</span>,</span>
<span>                             <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="st">"e.35_39"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"35-39"</span>,</span>
<span>                             <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="st">"e.40_44"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"40-44"</span>,</span>
<span>                             <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="st">"e.45_49"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"45-49"</span>,</span>
<span>                             <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="st">"e.50_54"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"50-54"</span>,</span>
<span>                             <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="st">"e.55_59"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"55-59"</span>,</span>
<span>                             <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="st">"e.60_64"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"60-64"</span>,</span>
<span>                             <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="st">"e.65_69"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"65-69"</span>,</span>
<span>                             <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="st">"e.70_74"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"70-74"</span>,</span>
<span>                             <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="st">"e.75"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"75"</span><span class="op">)</span>,</span>
<span>       ageclass<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">ageclass</span> , levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>         <span class="st">"0-4"</span>,  <span class="st">"5-9"</span>, <span class="st">"10-14"</span>,</span>
<span>         <span class="st">"15-19"</span>,  <span class="st">"20-24"</span>,  <span class="st">"25-29"</span>,</span>
<span>          <span class="st">"30-34"</span>,  <span class="st">"35-39"</span>,  <span class="st">"40-44"</span>,</span>
<span>          <span class="st">"45-49"</span>,  <span class="st">"50-54"</span>, <span class="st">"55-59"</span>,</span>
<span>         <span class="st">"60-64"</span>,  <span class="st">"65-69"</span>,  <span class="st">"70-74"</span>,  <span class="st">"75"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the population pyramid</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">combined_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ageclass</span>, y <span class="op">=</span> <span class="va">per</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">combined_data</span> <span class="op">|&gt;</span></span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">population</span> <span class="op">==</span> <span class="st">"Migrant"</span> <span class="op">&amp;</span></span>
<span>                            <span class="va">sex</span><span class="op">==</span><span class="st">"female."</span>  <span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>  y <span class="op">=</span>   <span class="va">per</span><span class="op">)</span>,</span>
<span>           stat <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>           <span class="co">#alpha =0.6,</span></span>
<span>            fill <span class="op">=</span>  <span class="fu"><a href="../reference/iom_pal.html">iom_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">combined_data</span> <span class="op">|&gt;</span></span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">population</span> <span class="op">==</span> <span class="st">"Migrant"</span> <span class="op">&amp;</span></span>
<span>                          <span class="va">sex</span><span class="op">==</span><span class="st">"male."</span>  <span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>  y <span class="op">=</span> <span class="op">-</span> <span class="va">per</span><span class="op">)</span>,</span>
<span>           <span class="co">#alpha =0.6,</span></span>
<span>           fill <span class="op">=</span> <span class="fu"><a href="../reference/iom_pal.html">iom_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_un"</span><span class="op">)</span>,</span>
<span>           stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">combined_data</span> <span class="op">|&gt;</span></span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">population</span> <span class="op">==</span> <span class="st">"Local"</span> <span class="op">&amp;</span></span>
<span>                      <span class="va">sex</span><span class="op">==</span><span class="st">"female."</span>  <span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span> yend <span class="op">=</span>  <span class="va">per</span>  <span class="op">)</span>,</span>
<span>           <span class="co">#alpha =0.3,</span></span>
<span>           lineend <span class="op">=</span> <span class="st">"round"</span>, linewidth <span class="op">=</span><span class="fl">2</span>,</span>
<span>           colour <span class="op">=</span>  <span class="st">"#CCCCCC"</span>,</span>
<span>           stat <span class="op">=</span> <span class="st">"identity"</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">combined_data</span> <span class="op">|&gt;</span></span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">population</span> <span class="op">==</span> <span class="st">"Local"</span> <span class="op">&amp;</span></span>
<span>                      <span class="va">sex</span><span class="op">==</span><span class="st">"male."</span>  <span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>  yend  <span class="op">=</span> <span class="op">-</span> <span class="va">per</span>  <span class="op">)</span>,</span>
<span>           <span class="co">#alpha =0.3,</span></span>
<span>           lineend <span class="op">=</span> <span class="st">"round"</span>, linewidth <span class="op">=</span><span class="fl">2</span>,</span>
<span>           colour <span class="op">=</span> <span class="st">"#CCCCCC"</span>,</span>
<span>           stat <span class="op">=</span> <span class="st">"identity"</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#coord_cartesian(clip = "off") +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"In Great Britain, Migrants predominantly fall</span></span>
<span><span class="st">                    within working-age groups"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Age Distribution of Migrant (bar) vs. </span></span>
<span><span class="st">                Local Populations (line) | 2020"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Age Group"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Population Count"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Sex"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">abs</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">.04</span>, x <span class="op">=</span> <span class="fl">17</span>, label <span class="op">=</span> <span class="st">"Male"</span>,</span>
<span>           size <span class="op">=</span> <span class="fl">12</span> <span class="op">/</span> <span class="va">.pt</span>,  </span>
<span>           hjust <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="fu"><a href="../reference/iom_pal.html">iom_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_un"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, y <span class="op">=</span> <span class="fl">.04</span>, x <span class="op">=</span> <span class="fl">17</span>, label <span class="op">=</span> <span class="st">"Female"</span>,</span>
<span>           size <span class="op">=</span> <span class="fl">12</span> <span class="op">/</span> <span class="va">.pt</span>,  </span>
<span>           hjust <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="fu"><a href="../reference/iom_pal.html">iom_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span></span>
<span>    axis_text <span class="op">=</span> <span class="st">"Y"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span>, grid <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/pyramid-plot-1.png" width="100%"></p>
</div>
</div>
<div class="section level3">
<h3 id="column-chart">Column chart<a class="anchor" aria-label="anchor" href="#column-chart"></a>
</h3>
<div class="section level4">
<h4 id="single-column">Single column<a class="anchor" aria-label="anchor" href="#single-column"></a>
</h4>
<p>A column chart is quite similar to a bar chart, but the bars are
vertical.</p>
<p>Let’s make a column chart of the last 10 years of total refugee
population.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Gather the data to long format for ggplot2</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data.sex.destination.origin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_destination</span> <span class="op">==</span> <span class="st">"WORLD"</span> <span class="op">&amp;</span></span>
<span>           <span class="va">region_development_group_country_or_area_of_origin</span> <span class="op">==</span> <span class="st">"WORLD"</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"year"</span>, value <span class="op">=</span> <span class="st">"total_migrants"</span>, <span class="va">total.1990</span><span class="op">:</span><span class="va">total.2020</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"total."</span>, <span class="st">""</span>, <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span></span>
<span><span class="co"># Summarize the total migrant population for each year</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total_migrants <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total_migrants</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">total_migrants</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span> fill <span class="op">=</span> <span class="fu"><a href="../reference/iom_pal.html">iom_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span> </span>
<span>        expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Over three decades, the numbers of migrants </span></span>
<span><span class="st">                   has almost doubled"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Trends in Global Migrant Population"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Total Migrants"</span>,</span>
<span>       caption <span class="op">=</span> <span class="va">caption</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/column-plot-1.png" width="100%"></p>
<p><strong>Plot with labels:</strong></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## We can just add some instructions on the top of the previously created plot</span></span>
<span><span class="co"># Plot with labels</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span></span>
<span>        scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        accuracy <span class="op">=</span> <span class="fl">.1</span></span>
<span>      <span class="op">)</span><span class="op">(</span><span class="va">total_migrants</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">.4</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/column-label-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="grouped-column">Grouped column<a class="anchor" aria-label="anchor" href="#grouped-column"></a>
</h4>
<p>Let’s compare Migrant population from different regions. We will use
a grouped column chart.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data.sex.destination.origin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_destination</span> <span class="op">==</span> <span class="st">"WORLD"</span> <span class="op">&amp;</span></span>
<span>           <span class="va">region_development_group_country_or_area_of_origin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Eastern Africa"</span>,</span>
<span>             <span class="st">"Middle Africa"</span>,</span>
<span>             <span class="st">"Northern Africa"</span>,</span>
<span>             <span class="st">"Southern Africa"</span>,</span>
<span>             <span class="st">"Western Africa"</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"year"</span>, value <span class="op">=</span> <span class="st">"total_migrants"</span>, <span class="va">total.2005</span><span class="op">:</span><span class="va">total.2020</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"total."</span>, <span class="st">""</span>, <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="co"># Summarize the total migrant population for each year</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span>,<span class="va">region_development_group_country_or_area_of_origin</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total_migrants <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total_migrants</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_origin</span>,</span>
<span>                          levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>                            <span class="st">"Northern Africa"</span>,</span>
<span>                            <span class="st">"Western Africa"</span>,</span>
<span>                            <span class="st">"Eastern Africa"</span>,</span>
<span>                            <span class="st">"Middle Africa"</span>,</span>
<span>                            <span class="st">"Southern Africa"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">total_migrants</span>,</span>
<span>              fill <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span> </span>
<span>            position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span>  option <span class="op">=</span><span class="st">"cividis"</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Eastern Africa now ranks as the second </span></span>
<span><span class="st">                region of Origin for Migrants from Africa"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Migrant Population Trends from African Regions"</span>,</span>
<span>       </span>
<span>       x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Total Migrants"</span>,</span>
<span>       caption <span class="op">=</span> <span class="va">caption</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/group-col-plot-1.png" width="100%"></p>
<p><strong>Plot with labels:</strong></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot with labels</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span></span>
<span>        scale <span class="op">=</span> <span class="fl">.000001</span>,</span>
<span>        accuracy <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>        suffix <span class="op">=</span> <span class="st">"M"</span></span>
<span>      <span class="op">)</span><span class="op">(</span><span class="va">total_migrants</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">.3</span></span>
<span>  <span class="op">)</span> </span>
<span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/group-col-label-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="stacked-column">Stacked column<a class="anchor" aria-label="anchor" href="#stacked-column"></a>
</h4>
<p>Let’s plot the total migrant population by region of destination from
1990 to 2020.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data.sex.destination.origin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_origin</span> <span class="op">==</span> <span class="st">"WORLD"</span> <span class="op">&amp;</span></span>
<span>          <span class="va">region_development_group_country_or_area_of_destination</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AFRICA"</span>, <span class="st">"ASIA"</span>, <span class="st">"EUROPE"</span>,</span>
<span>             <span class="st">"LATIN AMERICA AND THE CARIBBEAN"</span>, </span>
<span>             <span class="st">"NORTHERN AMERICA"</span>, <span class="st">"OCEANIA"</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"year"</span>, value <span class="op">=</span> <span class="st">"total_migrants"</span>, <span class="va">total.1990</span><span class="op">:</span><span class="va">total.2020</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"total."</span>, <span class="st">""</span>, <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="co"># Summarize the total migrant population for each year</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span>,<span class="va">region_development_group_country_or_area_of_destination</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total_migrants <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total_migrants</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>   <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> </span>
<span>    region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_destination</span>,</span>
<span>                          levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>                            <span class="st">"EUROPE"</span>,</span>
<span>                            <span class="st">"ASIA"</span>,</span>
<span>                            <span class="st">"NORTHERN AMERICA"</span>,</span>
<span>                            <span class="st">"LATIN AMERICA AND THE CARIBBEAN"</span>,</span>
<span>                            <span class="st">"AFRICA"</span>, </span>
<span>                            <span class="st">"OCEANIA"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">total_migrants</span>,</span>
<span>              fill <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span> position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html" class="external-link">position_stack</a></span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span>  option <span class="op">=</span><span class="st">"cividis"</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Migrant Population Distribution by Destination Region"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Total Migrants"</span>,</span>
<span>       caption <span class="op">=</span> <span class="va">caption</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    legend_text_size <span class="op">=</span> <span class="fl">9</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/stack-col-plot-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="stacked-column-1">100% stacked column<a class="anchor" aria-label="anchor" href="#stacked-column-1"></a>
</h4>
<p>Let’s create a 100% stacked column chart showing the total refugee
population for the last 10 years, by the each of the three UNHCR regions
in Africa.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data.sex.destination.origin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_origin</span> <span class="op">==</span> <span class="st">"WORLD"</span> <span class="op">&amp;</span></span>
<span>          <span class="va">region_development_group_country_or_area_of_destination</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AFRICA"</span>, <span class="st">"ASIA"</span>, <span class="st">"EUROPE"</span>, <span class="st">"LATIN AMERICA AND THE CARIBBEAN"</span>, <span class="st">"NORTHERN AMERICA"</span>, <span class="st">"OCEANIA"</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"year"</span>, value <span class="op">=</span> <span class="st">"total_migrants"</span>, <span class="va">total.1990</span><span class="op">:</span><span class="va">total.2020</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"total."</span>, <span class="st">""</span>, <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="co"># Summarize the total migrant population for each year</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span>,<span class="va">region_development_group_country_or_area_of_destination</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total_migrants <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total_migrants</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>   <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>percent_migrants <span class="op">=</span> <span class="va">total_migrants</span><span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total_migrants</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>   <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_destination</span>,</span>
<span>                          levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>                            <span class="st">"EUROPE"</span>,</span>
<span>                            <span class="st">"ASIA"</span>,</span>
<span>                            <span class="st">"NORTHERN AMERICA"</span>,</span>
<span>                            <span class="st">"LATIN AMERICA AND THE CARIBBEAN"</span>,</span>
<span>                            <span class="st">"AFRICA"</span>, </span>
<span>                            <span class="st">"OCEANIA"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">percent_migrants</span>,</span>
<span>              fill <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span> position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html" class="external-link">position_stack</a></span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html" class="external-link">label_percent</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span>  option <span class="op">=</span><span class="st">"cividis"</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Evolution of Migrant Population per Region of Destination"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Total Migrants"</span>,</span>
<span>       caption <span class="op">=</span> <span class="va">caption</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    legend_text_size <span class="op">=</span> <span class="fl">9</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/percent-stack-plot-1.png" width="100%"></p>
</div>
</div>
<div class="section level3">
<h3 id="line-chart">Line chart<a class="anchor" aria-label="anchor" href="#line-chart"></a>
</h3>
<p>Some key points to consider when designing bar chart are:</p>
<ul>
<li><p>The purpose of the line chart is to show a trend. It is often the
best solution when the data presents a time series referring to a single
value that changes at regular intervals.</p></li>
<li><p>Choose the y-axis scale appropriately so that we can see the
trend. Too flat obscures the message and too exaggerated overstates the
trend. The right height is two-thirds of the chart area.</p></li>
<li><p>The weight of the fever line should be thick enough to stand out
against the grid line but still thin enough to show the twists and turns
of the line. Keep the grid lines thin.</p></li>
<li><p>Unlike a bar chart, a fever line does not necessarily require a
zero baseline. Some data trend won’t be discernible starting from zero
baseline.</p></li>
<li><p>Avoid labeling at long distance, a legend separated from the line
requires the readers to do extra work cross-referencing between the key
and the line. Label the lines directly. Direct labeling allows the
reader to identify the lines quickly and focus on comparing and
contrasting the patterns.</p></li>
<li><p>Use the legend only when the space is tight and the lines
intersect extensively. The order of the legend should match the ranking
of the end points since they are the most current data points.</p></li>
<li><p>Annotations help to clarify the message.</p></li>
</ul>
<div class="section level4">
<h4 id="single-line">Single line<a class="anchor" aria-label="anchor" href="#single-line"></a>
</h4>
<p>Let’s plot the evolution of the total remittance.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Fetch data from the World Bank API</span></span>
<span><span class="va">remittance_data</span> <span class="op">&lt;-</span> <span class="fu">WDI</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/WDI/man/WDI.html" class="external-link">WDI</a></span><span class="op">(</span>indicator <span class="op">=</span> <span class="st">"BX.TRF.PWKR.CD.DT"</span>, </span>
<span>                            start <span class="op">=</span> <span class="fl">1990</span>, </span>
<span>                            end <span class="op">=</span> <span class="fl">2023</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarize the data to get the total remittances worldwide for each year</span></span>
<span><span class="va">global_remittance_data</span> <span class="op">&lt;-</span> <span class="va">remittance_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># filter(!country %in% c("World", "High income", "Low income", "Middle income", </span></span>
<span>  <span class="co">#                        "Upper middle income", "Lower middle income", </span></span>
<span>  <span class="co">#                        "East Asia &amp; Pacific", </span></span>
<span>  <span class="co">#                        "Europe &amp; Central Asia", "Latin America &amp; Caribbean", </span></span>
<span>  <span class="co">#                        "Middle East &amp; North Africa",</span></span>
<span>  <span class="co">#                        "South Asia", "Sub-Saharan Africa")) |&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"World"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total_remittances <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">BX.TRF.PWKR.CD.DT</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">global_remittance_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">total_remittances</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="fu"><a href="../reference/iom_pal.html">iom_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"With now "</span>,</span>
<span>                      <span class="va">global_remittance_data</span> <span class="op">|&gt;</span> </span>
<span>                        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>                        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">total_remittances</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>                        <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span></span>
<span>                          scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="st">" USD, the Amount of Annual Global Remittance has been multiplied by "</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">global_remittance_data</span><span class="op">$</span><span class="va">total_remittances</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">global_remittance_data</span><span class="op">$</span><span class="va">total_remittances</span><span class="op">)</span>,<span class="fl">0</span><span class="op">)</span>, <span class="st">" since 1990"</span><span class="op">)</span>,     </span>
<span>    subtitle <span class="op">=</span> <span class="st">"Global Flow of personal transfers and compensation of employees</span></span>
<span><span class="st">                across Countries in USD"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Total Remittances (Current US$)"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Personal transfers consist of all current transfers in cash or</span></span>
<span><span class="st">    in kind made or received by resident households to or from nonresident</span></span>
<span><span class="st">    households. Personal transfers thus include all current transfers between</span></span>
<span><span class="st">    resident and nonresident individuals. Compensation of employees refers to</span></span>
<span><span class="st">    the income of border, seasonal, and other short-term workers who are </span></span>
<span><span class="st">    employed in an economy where they are not resident and of residents employed</span></span>
<span><span class="st">    by nonresident entities. </span></span>
<span><span class="st">    Source: World bank Data - Indicator BX.TRF.PWKR.CD.DT"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="co">#scale_x_discrete( breaks = scales::pretty_breaks(n = 5)   ) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span> labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/single-line-plot-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="multiple-line">Multiple line<a class="anchor" aria-label="anchor" href="#multiple-line"></a>
</h4>
<p>Some additional points to consider when designing a multiple line
chart;</p>
<ul>
<li><p>Don’t use dashed lines and shape markers to differentiate each
line! You can use solid lines exclusively by limiting the chart to four
or fewer lines. Varying weights and shades do the work of
differentiating the lines more effectively than distracting patterns and
markers.</p></li>
<li><p>In a single chart, keep the maximum number of lines to three or
possibly four if the lines are not intersecting at many points. The
purpose of a multiple-line chart is to compare and contrast different
data series.</p></li>
<li><p>The most important line should be one color and the other lines
should be shades of second colors.</p></li>
</ul>
<p>Let’s plot the comparison total remittance with Development Aid.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">ssa_remittance</span> <span class="op">&lt;-</span> <span class="va">remittance_data</span> <span class="op">|&gt;</span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"South Asia"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co">#filter(country %in% c("Sub-Saharan Africa (IDA &amp; IBRD countries)")) |&gt;</span></span>
<span> <span class="co">#  filter(country %in% c("Heavily indebted poor countries (HIPC)")) |&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total_remittances <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">BX.TRF.PWKR.CD.DT</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fetch data from the World Bank API for public development aid funding</span></span>
<span></span>
<span><span class="co">##We could use DT.ODA.OATL.KD Net official aid received (constant 2021 US$)</span></span>
<span><span class="co"># Development Assistance Committee of  Organisation for Economic Co-operation </span></span>
<span><span class="co"># and Development, Geographical Distribution of Financial Flows to Developing </span></span>
<span><span class="co"># Countries, Development Co-operation Report, and International Development </span></span>
<span><span class="co"># Statistics database</span></span>
<span></span>
<span><span class="co">##  DT.ODA.ALLD.CD -- Net official development assistance and </span></span>
<span><span class="co"># official aid received (current US$)</span></span>
<span></span>
<span><span class="va">oda_data</span> <span class="op">&lt;-</span> <span class="fu">WDI</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/WDI/man/WDI.html" class="external-link">WDI</a></span><span class="op">(</span>indicator <span class="op">=</span> <span class="st">"DT.ODA.ALLD.CD"</span>, start <span class="op">=</span> <span class="fl">1990</span>, end <span class="op">=</span> <span class="fl">2020</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarize data to get the total public development aid funding for each year</span></span>
<span><span class="va">ssa_oda</span>  <span class="op">&lt;-</span> <span class="va">oda_data</span> <span class="op">|&gt;</span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"South Asia"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co">#filter(country %in% c("Sub-Saharan Africa (IDA &amp; IBRD countries)")) |&gt;</span></span>
<span> <span class="co">#  filter(country %in% c("Heavily indebted poor countries (HIPC)")) |&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>public_development_aid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">DT.ODA.ALLD.CD</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine the two data sets</span></span>
<span><span class="va">combined_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">ssa_oda</span>, <span class="va">ssa_remittance</span>, by <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">combined_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">public_development_aid</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="fu"><a href="../reference/iom_pal.html">iom_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_green"</span><span class="op">)</span>,</span>
<span>            linewidth <span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">total_remittances</span><span class="op">)</span>, </span>
<span>            color <span class="op">=</span> <span class="fu"><a href="../reference/iom_pal.html">iom_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span>,</span>
<span>            linewidth <span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"In South Asia, &lt;span style='color:"</span>,</span>
<span>          <span class="fu"><a href="../reference/iom_pal.html">iom_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span>, <span class="st">"'&gt;"</span>,</span>
<span>          <span class="st">"Personal Remittance&lt;/span&gt; amounts are now "</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">combined_data</span> <span class="op">|&gt;</span> </span>
<span>                  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>                  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">total_remittances</span><span class="op">)</span> <span class="op">/</span> </span>
<span>                 <span class="va">combined_data</span> <span class="op">|&gt;</span> </span>
<span>                  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>                  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">public_development_aid</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span></span>
<span>          <span class="st">" bigger than &lt;span style='color:"</span>,</span>
<span>          <span class="fu"><a href="../reference/iom_pal.html">iom_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_green"</span><span class="op">)</span>, <span class="st">"'&gt;"</span>,</span>
<span>          <span class="st">"Official Development &amp; Aid Assistance&lt;/span&gt;"</span><span class="op">)</span> ,</span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Funding (Current US$)"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Source: World bank Data - </span></span>
<span><span class="st">               Indicator BX.TRF.PWKR.CD.DT &amp; DT.ODA.ALLD.CD"</span><span class="op">)</span> <span class="op">+</span> </span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/multi-line-plot-1.png" width="100%"></p>
<p><strong>Plot with labels:</strong></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot with labels</span></span>
<span><span class="co"># Summarize the data to get the total remittances worldwide for each year</span></span>
<span><span class="va">global_remittance_data_income</span> <span class="op">&lt;-</span> <span class="va">remittance_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># filter(country %in% c(  "High income", "Low income", "Middle income", </span></span>
<span>  <span class="co">#                         "Upper middle income", "Lower middle income" )) |&gt; </span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="st">"Africa Eastern and Southern"</span>,</span>
<span>                          <span class="st">"Africa Western and Central"</span>,  </span>
<span>                          <span class="st">"Middle East &amp; North Africa"</span> <span class="op">)</span> <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># filter(country %in% c( "East Asia &amp; Pacific", </span></span>
<span>  <span class="co">#                        "Europe &amp; Central Asia", </span></span>
<span>  <span class="co">#                        "Latin America &amp; Caribbean", </span></span>
<span>  <span class="co">#                        "Middle East &amp; North Africa",</span></span>
<span>  <span class="co">#                        "North America",</span></span>
<span>  <span class="co">#                        "South Asia", </span></span>
<span>  <span class="co">#                        "Sub-Saharan Africa")) |&gt; </span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">country</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total_remittances <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">BX.TRF.PWKR.CD.DT</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## check total</span></span>
<span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="va">global_remittance_data_income</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, </span>
<span>              y <span class="op">=</span> <span class="va">total_remittances</span>,</span>
<span>              color <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">global_remittance_data_income</span>, <span class="va">year</span> <span class="op">==</span> <span class="fl">2023</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span> label <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html" class="external-link">str_wrap</a></span><span class="op">(</span><span class="va">country</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>         color <span class="op">=</span> <span class="va">country</span> <span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    nudge_x <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="co">## let's expand scales to add the labels at the right side of the plot</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.01</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.32</span><span class="op">)</span><span class="op">)</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"The ability to benefit and rely on remittance do vary"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Evolution of Remittances per Region in Africa (USD)"</span>,</span>
<span>     x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>     y <span class="op">=</span> <span class="st">"Total Remittances (Current US$)"</span>,</span>
<span>     caption <span class="op">=</span> <span class="st">"Personal remittances comprise personal transfers</span></span>
<span><span class="st">                and compensation of employees.  </span></span>
<span><span class="st">                Source: World bank Data - Indicator BX.TRF.PWKR.CD.DT"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="co">#scale_x_discrete( breaks = scales::pretty_breaks(n = 5)   ) +</span></span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span></span>
<span>    grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    plot_margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">40</span>, <span class="fl">12</span>, <span class="fl">12</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/multi-line-label-1.png" width="100%"></p>
</div>
</div>
<div class="section level3">
<h3 id="area-chart">Area chart<a class="anchor" aria-label="anchor" href="#area-chart"></a>
</h3>
<div class="section level4">
<h4 id="single-area">Single area<a class="anchor" aria-label="anchor" href="#single-area"></a>
</h4>
<p>Let’s plot the evolution of the total number of Migrants.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data.sex.destination.origin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_destination</span> <span class="op">==</span> <span class="st">"WORLD"</span> <span class="op">&amp;</span></span>
<span>           <span class="va">region_development_group_country_or_area_of_origin</span> <span class="op">==</span> <span class="st">"WORLD"</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"year"</span>, value <span class="op">=</span> <span class="st">"total_migrants"</span>, <span class="va">total.1990</span><span class="op">:</span><span class="va">total.2020</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"total."</span>, <span class="st">""</span>, <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span><span class="co"># Summarize the total migrant population for each year</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total_migrants <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total_migrants</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>data_type <span class="op">=</span> <span class="st">"Observed"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## a good story here could be to show how thing would like following the trend</span></span>
<span><span class="co"># Calculate the slope for linear extrapolation</span></span>
<span><span class="va">slope</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">last</a></span><span class="op">(</span><span class="va">total_migrants</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">nth</a></span><span class="op">(</span><span class="va">total_migrants</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">last</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">nth</a></span><span class="op">(</span><span class="va">year</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">slope</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Expand the table after 2020 only every five years up to 2100 using linear extrapolation</span></span>
<span><span class="va">expanded_migrants</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="fl">2040</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  total_migrants <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">last</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">total_migrants</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                        <span class="va">slope</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="fl">2040</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">-</span> </span>
<span>                                   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">last</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>data_type<span class="op">=</span><span class="st">"Extrapolated"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine the original and expanded data</span></span>
<span><span class="va">combined_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">expanded_migrants</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="co">#|&gt;</span></span>
<span> <span class="co"># mutate(year = as_factor(year)) </span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combined_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span>,</span>
<span>              y <span class="op">=</span> <span class="va">total_migrants</span>,</span>
<span>              group <span class="op">=</span> <span class="fl">1</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">combined_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="va">data_type</span> <span class="op">==</span> <span class="st">"Observed"</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"#0033A0"</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">combined_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="va">data_type</span> <span class="op">==</span> <span class="st">"Observed"</span><span class="op">)</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"#0033A0"</span>,</span>
<span>    linewidth <span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">combined_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="va">data_type</span> <span class="op">==</span> <span class="st">"Extrapolated"</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"#8F9DF7"</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">combined_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="va">data_type</span> <span class="op">==</span> <span class="st">"Extrapolated"</span><span class="op">)</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"#8F9DF7"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>    linewidth <span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span> </span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>       title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>         <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="va">combined_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="va">data_type</span> <span class="op">==</span> <span class="st">"Extrapolated"</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">==</span> <span class="fl">2020</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">total_migrants</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="st">" migrants in 2020 and potentially up to "</span>,                      </span>
<span>         </span>
<span>         <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="va">combined_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="va">data_type</span> <span class="op">==</span> <span class="st">"Extrapolated"</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">==</span><span class="fl">2040</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">total_migrants</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              <span class="st">" migrants in 2040"</span><span class="op">)</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Growth of the Global Migrant Population"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Total Migrants"</span>,</span>
<span>       caption <span class="op">=</span> <span class="va">caption</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"y"</span>, </span>
<span>            axis <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>            axis_ticks <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>            axis_title <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>            legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/area-plot-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="stacked-area">Stacked area<a class="anchor" aria-label="anchor" href="#stacked-area"></a>
</h4>
<p>Let’s plot the evolution of the total migrants according to Economic
level of the country of Origin.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#dput(levels(as.factor(data.sex.destination.origin$region_development_group_country_or_area_of_origin)))</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data.sex.destination.origin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_destination</span> <span class="op">==</span> <span class="st">"WORLD"</span> <span class="op">&amp;</span></span>
<span>           <span class="va">region_development_group_country_or_area_of_origin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   </span>
<span> <span class="st">"High-income countries"</span>,</span>
<span> <span class="st">"Middle-income countries"</span>,</span>
<span> <span class="st">"Low-income countries"</span></span>
<span><span class="op">)</span>  <span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"year"</span>, value <span class="op">=</span> <span class="st">"total_migrants"</span>, <span class="va">total.1990</span><span class="op">:</span><span class="va">total.2020</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"total."</span>, <span class="st">""</span>, <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span></span>
<span><span class="co"># Summarize the total migrant population for each year</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">region_development_group_country_or_area_of_origin</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total_migrants <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total_migrants</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_origin</span>,</span>
<span>                          levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  <span class="st">"High-income countries"</span>,</span>
<span>                                       <span class="st">"Middle-income countries"</span>,</span>
<span>                                       <span class="st">"Low-income countries"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>,</span>
<span>              y <span class="op">=</span> <span class="va">total_migrants</span>,</span>
<span>              group <span class="op">=</span> <span class="va">region</span>,</span>
<span>              fill <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span> alpha <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span> </span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Migration is predominant in Middle Income Countries"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Total Migrant Population per Destination"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Total Migrants"</span>,</span>
<span>       caption <span class="op">=</span> <span class="va">caption</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/stack-area-plot-1.png" width="100%"></p>
</div>
</div>
<div class="section level3">
<h3 id="pie-chart">Pie chart<a class="anchor" aria-label="anchor" href="#pie-chart"></a>
</h3>
<p>Let’s plot the percentage of migrants &amp; refugees within the world
population.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_population</span> <span class="op">&lt;-</span> <span class="fu">WDI</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/WDI/man/WDI.html" class="external-link">WDI</a></span><span class="op">(</span>indicator <span class="op">=</span> <span class="st">"SP.POP.TOTL"</span>,</span>
<span>                            start <span class="op">=</span> <span class="fl">1990</span>,</span>
<span>                            end <span class="op">=</span> <span class="fl">2020</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"World"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>population <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">SP.POP.TOTL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_refugee</span> <span class="op">&lt;-</span> <span class="fu">WDI</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/WDI/man/WDI.html" class="external-link">WDI</a></span><span class="op">(</span>indicator <span class="op">=</span> <span class="st">"SM.POP.REFG"</span>, </span>
<span>                         start <span class="op">=</span> <span class="fl">1990</span>, </span>
<span>                         end <span class="op">=</span> <span class="fl">2020</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"World"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>refugee <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">SM.POP.REFG</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_migrants</span> <span class="op">&lt;-</span> <span class="va">data.sex.destination.origin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_destination</span> <span class="op">==</span> <span class="st">"WORLD"</span> <span class="op">&amp;</span></span>
<span>           <span class="va">region_development_group_country_or_area_of_origin</span> <span class="op">==</span> <span class="st">"WORLD"</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"year"</span>, value <span class="op">=</span> <span class="st">"total_migrants"</span>, <span class="va">total.1990</span><span class="op">:</span><span class="va">total.2020</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"total."</span>, <span class="st">""</span>, <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Summarize the total migrant population for each year</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>migrants <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total_migrants</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Combine the data frames</span></span>
<span><span class="va">combined_data</span> <span class="op">&lt;-</span> <span class="va">data_migrants</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">data_refugee</span>, by <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">data_population</span>, by <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Migrants <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">migrants</span> <span class="op">/</span> <span class="va">population</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span> ,</span>
<span>    Refugees <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">refugee</span> <span class="op">/</span> <span class="va">population</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span> ,</span>
<span>    Population <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">Migrants</span> <span class="op">-</span>  <span class="va">Refugees</span> <span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="va">year</span> <span class="op">==</span> <span class="fl">2020</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"type"</span>, value <span class="op">=</span> <span class="st">"percent"</span>, <span class="va">Migrants</span>, <span class="va">Refugees</span>, <span class="va">Population</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">type</span>, <span class="va">percent</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combined_data</span> <span class="op">|&gt;</span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span> x <span class="op">=</span> <span class="fl">1</span>,</span>
<span>              y <span class="op">=</span> <span class="va">percent</span>,</span>
<span>              fill <span class="op">=</span> <span class="va">type</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_label_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">combined_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="va">type</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Migrants"</span>, <span class="st">"Refugees"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">type</span>, <span class="st">"\n"</span>, <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html" class="external-link">label_percent</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="va">percent</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">percent</span><span class="op">)</span> <span class="op">-</span> <span class="va">percent</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"#ffffff"</span>, </span>
<span>    color<span class="op">=</span><span class="st">"black"</span>, </span>
<span>    segment.colour<span class="op">=</span><span class="st">"grey"</span>,</span>
<span>    arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="st">"npc"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    box.padding <span class="op">=</span> <span class="fl">1</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/iom_scale.html">scale_fill_iom_d</a></span><span class="op">(</span> nmax <span class="op">=</span> <span class="fl">3</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html" class="external-link">coord_polar</a></span><span class="op">(</span> theta <span class="op">=</span> <span class="st">"y"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Less than 4% of the World Population</span></span>
<span><span class="st">             is actually migrating internationally"</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span>void <span class="op">=</span> <span class="cn">TRUE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/pie-plot-1.png" width="100%"></p>
<p><strong>Donut Plot:</strong></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">combined_data</span> <span class="op">|&gt;</span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span> x <span class="op">=</span> <span class="fl">1</span>,</span>
<span>              y <span class="op">=</span> <span class="va">percent</span>,</span>
<span>              fill <span class="op">=</span> <span class="va">type</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## labels ussing ggrepel</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_label_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">combined_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="va">type</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Migrants"</span>, <span class="st">"Refugees"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">type</span>, <span class="st">"\n"</span>, <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html" class="external-link">label_percent</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="va">percent</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">percent</span><span class="op">)</span> <span class="op">-</span> <span class="va">percent</span> <span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"#ffffff"</span>, </span>
<span>    color<span class="op">=</span><span class="st">"black"</span>, </span>
<span>    <span class="co"># segment.colour="grey",</span></span>
<span>    <span class="co"># arrow = arrow(length = unit(0.01, "npc")),</span></span>
<span>    box.padding <span class="op">=</span> <span class="fl">1</span> <span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="fu"><a href="../reference/iom_scale.html">scale_fill_iom_d</a></span><span class="op">(</span> nmax <span class="op">=</span> <span class="fl">3</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/iom_scale.html">scale_color_iom_d</a></span><span class="op">(</span>nmax <span class="op">=</span> <span class="fl">3</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>  expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html" class="external-link">coord_polar</a></span><span class="op">(</span></span>
<span>    theta <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>    direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>    clip <span class="op">=</span> <span class="st">"off"</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"96% of the World Population is not migrating"</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span>void <span class="op">=</span> <span class="cn">TRUE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/donut-plot-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="maps">Maps<a class="anchor" aria-label="anchor" href="#maps"></a>
</h3>
<p>A map is a graphic representation or scale model of spatial concepts.
It is a means for conveying geographic information. Maps are a universal
medium for communication, easily understood and appreciated by most
people, regardless of language or culture. Maps are not realistic
representations of the actual world. All maps are estimations,
generalizations, and interpretations of true geographic conditions.</p>
<p>One key rule when creating a map is:</p>
<ol style="list-style-type: decimal">
<li>Absolute value: Proportional symbol</li>
<li>Relative value (ratio): Choropleth</li>
</ol>
<p>Ggplot2 has amazing capacity to work directly with geographic
information.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get world map data from rnaturalearth</span></span>
<span><span class="va">world</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html" class="external-link">ne_countries</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="st">"medium"</span>, returnclass <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Remove Antarctica</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sovereignt</span> <span class="op">!=</span> <span class="st">"Antarctica"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Transform the world map to Bertin 1953 projection</span></span>
<span>  <span class="co"># sf::st_transform(world, crs = "+proj=bertin1953")</span></span>
<span>  <span class="co"># Transform the world map to Robinson projection</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">world</span>, crs <span class="op">=</span> <span class="st">"ESRI:54030"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Better alternative</span></span>
<span><span class="va">centroid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"https://github.com/gavinr/world-countries-centroids/raw/refs/heads/master/dist/countries.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Remove centroid for sub territories</span></span>
<span><span class="va">centroid.unique</span> <span class="op">&lt;-</span> <span class="va">centroid</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="va">ISO</span> <span class="op">==</span> <span class="va">AFF_ISO</span> <span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="va">COUNTRY</span> <span class="op">!=</span> <span class="st">"Canarias"</span> <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Convert to an sf object</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="co"># Transform the coordinates</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="st">"ESRI:54030"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Extract the transformed coordinates back into separate columns</span></span>
<span>  <span class="co">#centroid.unique1 &lt;- centroid.unique</span></span>
<span>  <span class="co"># Extract the transformed coordinates back into separate columns</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>long <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">geometry</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>                lat <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">geometry</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="proportional-symbols">Proportional Symbols<a class="anchor" aria-label="anchor" href="#proportional-symbols"></a>
</h4>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Summarize the total migrant population for each country of destination in 2020</span></span>
<span><span class="va">summary_data</span> <span class="op">&lt;-</span> <span class="va">data.sex.destination.origin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="st">"destination.iso2"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_destination</span>, <span class="va">destination.iso2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total.2020</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Merge the data</span></span>
<span><span class="va">merged_data</span> <span class="op">&lt;-</span> <span class="va">summary_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">centroid.unique</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"destination.iso2"</span><span class="op">=</span><span class="st">"ISO"</span> <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Create natural breaks for the value classes</span></span>
<span><span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu">classInt</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/classInt/reference/classIntervals.html" class="external-link">classIntervals</a></span><span class="op">(</span><span class="va">merged_data</span><span class="op">$</span><span class="va">total</span>, n <span class="op">=</span> <span class="fl">5</span>, style <span class="op">=</span> <span class="st">"jenks"</span><span class="op">)</span><span class="op">$</span><span class="va">brks</span></span>
<span><span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">breaks</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">breaks</span><span class="op">)</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">" - "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">breaks</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"]"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">label_top_10</span> <span class="op">&lt;-</span>  <span class="va">merged_data</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">total</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="st">"COUNTRY"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>    <span class="va">destination.iso2</span>, <span class="st">": "</span>,</span>
<span>    <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span>, scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="va">total</span><span class="op">)</span>,</span>
<span>    <span class="st">" "</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Plot the world map with proportional symbols at centroids</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">world</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightgray"</span>, alpha <span class="op">=</span> <span class="fl">0.8</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">merged_data</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>,</span>
<span>                 y <span class="op">=</span> <span class="va">lat</span>,</span>
<span>                 size <span class="op">=</span> <span class="va">total</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"#0033A0"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size_continuous</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">40</span><span class="op">)</span>,breaks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, labels <span class="op">=</span> <span class="va">labels</span><span class="op">)</span> <span class="op">+</span> <span class="co">#</span></span>
<span>  <span class="co"># ggrepel::geom_label_repel(data = label_top_10,</span></span>
<span>  <span class="co">#                           aes(x = long,</span></span>
<span>  <span class="co">#                               y = lat,</span></span>
<span>  <span class="co">#                               # label = scales::label_number(accuracy = 1, scale_cut = cut_short_scale())(total))</span></span>
<span>  <span class="co">#                               label = label)    ) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Total Migrant Population per Country of Destination in 2020"</span>,</span>
<span>    <span class="co"># subtitle = paste0("Données Lissées pour 2024/25 - Estimation pour un an: ",</span></span>
<span>    <span class="co">#                   scales::label_number(</span></span>
<span>    <span class="co">#                     accuracy = 1,</span></span>
<span>    <span class="co">#                     scale_cut = scales::cut_short_scale())</span></span>
<span>    <span class="co">#                   (sum(summary_data$total)),</span></span>
<span>    <span class="co">#                   "$"),</span></span>
<span>    x<span class="op">=</span><span class="st">""</span>,</span>
<span>    y <span class="op">=</span> <span class="st">""</span>,</span>
<span>   <span class="co"># caption = caption,</span></span>
<span>    size <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span>void <span class="op">=</span> <span class="cn">TRUE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="choropleth">Choropleth<a class="anchor" aria-label="anchor" href="#choropleth"></a>
</h4>
<p>Net Annual Migration per 1,000 population (average 2015/2020)</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> </span>
<span></span>
<span><span class="co"># Calculate Net Annual Migration per 1,000 population (average 2015/2020)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data.sex.destination.origin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>net_migration_per_1000 <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">total.2020</span> <span class="op">-</span> <span class="va">total.2015</span><span class="op">)</span> <span class="op">/</span> <span class="va">total.2015</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">100</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2020</span> <span class="op">-</span> <span class="fl">2015</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span></span>
<span><span class="co"># Summarize the net migration per 1,000 population for each country of destination</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="st">"destination.iso2"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_destination</span>,</span>
<span>           <span class="va">destination.iso2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>net_migration_per_1000 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">net_migration_per_1000</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Merge the data with the world map</span></span>
<span><span class="va">merged_data</span> <span class="op">&lt;-</span> <span class="va">world</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">data</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"iso_a2"</span> <span class="op">=</span> <span class="st">"destination.iso2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the proportional map</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">merged_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">net_migration_per_1000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, </span>
<span>                       na.value <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Net Annual Migration per 1,000 population"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Average 2015/2020"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Total Migrants"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span>void <span class="op">=</span> <span class="cn">TRUE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="flow-maps">Flow Maps<a class="anchor" aria-label="anchor" href="#flow-maps"></a>
</h4>
<p>Flow map can be used to generate curved arrows, with a size adjusted
to the magniture of the flow. We will now build a map for the top 10
country-to-country migration corridor that have a destination country in
the european union in 2020</p>
</div>
</div>
<div class="section level3">
<h3 id="association">Association<a class="anchor" aria-label="anchor" href="#association"></a>
</h3>
<div class="section level4">
<h4 id="scatter-plot">Scatter Plot<a class="anchor" aria-label="anchor" href="#scatter-plot"></a>
</h4>
<p>Scatter plot are used to check for correlation. A trend line can be
added to compare two set of measures to determine if as one set goes up,
the other set correspondingly goes up or down and how strongly.</p>
<p>Scatter plot are also a good way to identify clusters of
observation.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fetch Human Development Index (HDI) data</span></span>
<span><span class="va">human_capital_data</span> <span class="op">&lt;-</span> <span class="fu">WDI</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/WDI/man/WDI.html" class="external-link">WDI</a></span><span class="op">(</span>indicator <span class="op">=</span> <span class="st">"HD.HCI.OVRL"</span>, start <span class="op">=</span> <span class="fl">2020</span>, end <span class="op">=</span> <span class="fl">2020</span><span class="op">)</span></span>
<span></span>
<span><span class="va">remt_Per_data</span> <span class="op">&lt;-</span> <span class="fu">WDI</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/WDI/man/WDI.html" class="external-link">WDI</a></span><span class="op">(</span>indicator <span class="op">=</span> <span class="st">"BX.TRF.PWKR.DT.GD.ZS"</span>, start <span class="op">=</span> <span class="fl">2020</span>, end <span class="op">=</span> <span class="fl">2020</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># Combine the data</span></span>
<span><span class="va">combined_data</span> <span class="op">&lt;-</span> <span class="va">human_capital_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">HD.HCI.OVRL</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">remt_Per_data</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"iso2c"</span>, <span class="st">"year"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> region <span class="op">=</span> <span class="fu">countrycode</span><span class="fu">::</span><span class="fu"><a href="https://vincentarelbundock.github.io/countrycode/reference/countrycode.html" class="external-link">countrycode</a></span><span class="op">(</span><span class="va">iso2c</span>, </span>
<span>                                            origin <span class="op">=</span> <span class="st">"iso2c"</span>, </span>
<span>                                            destination <span class="op">=</span> <span class="st">"region"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span> <span class="op">(</span><span class="va">BX.TRF.PWKR.DT.GD.ZS</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the scatter plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">combined_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">HD.HCI.OVRL</span>, y <span class="op">=</span> <span class="va">BX.TRF.PWKR.DT.GD.ZS</span>, color <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## labels ussing ggrepel</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_label_repel</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>  label <span class="op">=</span> <span class="va">country.x</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"#ffffff"</span>, </span>
<span>    color<span class="op">=</span><span class="st">"black"</span>, </span>
<span>    size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    <span class="co"># segment.colour="grey",</span></span>
<span>    <span class="co"># arrow = arrow(length = unit(0.01, "npc")),</span></span>
<span>    box.padding <span class="op">=</span> <span class="fl">1</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span> </span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Remittances vs Human Capital Index (2020)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Human Capital Index (HCI)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Remittances (% of GDP)"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>        caption <span class="op">=</span> <span class="st">"Source: World Bank Global Development Data - data.worldbank.org - HD.HCI.OVRL / BX.TRF.PWKR.DT.GD.ZS "</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span> legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/scatter-plot-1.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="forrest-plot">Forrest Plot<a class="anchor" aria-label="anchor" href="#forrest-plot"></a>
</h4>
</div>
</div>
<div class="section level3">
<h3 id="other-charts">Other Charts<a class="anchor" aria-label="anchor" href="#other-charts"></a>
</h3>
<p>These less common type of charts can be created with the help of the
<a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> and <a href="https://github.com/iom/iomthemes" class="external-link">iomthemes</a> packages but will
require extra packages. When needed, the code to install the extra
packages will be provided.</p>
<div class="section level4">
<h4 id="treemap">Treemap<a class="anchor" aria-label="anchor" href="#treemap"></a>
</h4>
<p>Let’s make a treemap of the migrant region of origin in 2022 for the
G7 Countries. For this we will use the <a href="https://github.com/wilkox/treemapify" class="external-link"><code>{treemapify}</code></a>
package.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g7_countries_iso</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"US"</span>, <span class="st">"CA"</span>, <span class="st">"FR"</span>, <span class="st">"DE"</span>, <span class="st">"IT"</span>, <span class="st">"JP"</span>, <span class="st">"GB"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_g7</span> <span class="op">&lt;-</span> <span class="va">data.sex.destination.origin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">destination.iso2</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">g7_countries_iso</span> <span class="op">&amp;</span></span>
<span>           <span class="va">region_development_group_country_or_area_of_origin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AFRICA"</span>, <span class="st">"ASIA"</span>, <span class="st">"EUROPE"</span>,</span>
<span>                                                                     <span class="st">"LATIN AMERICA AND THE CARIBBEAN"</span>,</span>
<span>                                                                     <span class="st">"NORTHERN AMERICA"</span>, <span class="st">"OCEANIA"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarize the total number of migrants by region of origin</span></span>
<span><span class="va">summary_data</span> <span class="op">&lt;-</span> <span class="va">data_g7</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_destination</span>, <span class="va">region_development_group_country_or_area_of_origin</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total_migrants <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total.2020</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the treemap with two levels: G7 countries and region of origin</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">summary_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>area <span class="op">=</span> <span class="va">total_migrants</span>, fill <span class="op">=</span> <span class="va">region_development_group_country_or_area_of_origin</span>, </span>
<span>                         subgroup <span class="op">=</span> <span class="va">region_development_group_country_or_area_of_destination</span>, </span>
<span>                         label <span class="op">=</span> <span class="va">region_development_group_country_or_area_of_origin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">treemapify</span><span class="fu">::</span><span class="fu"><a href="https://wilkox.org/treemapify/reference/geom_treemap.html" class="external-link">geom_treemap</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">treemapify</span><span class="fu">::</span><span class="fu"><a href="https://wilkox.org/treemapify/reference/geom_treemap_subgroup_border.html" class="external-link">geom_treemap_subgroup_border</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## The labels</span></span>
<span>  <span class="fu">treemapify</span><span class="fu">::</span><span class="fu"><a href="https://wilkox.org/treemapify/reference/geom_treemap_subgroup_text.html" class="external-link">geom_treemap_subgroup_text</a></span><span class="op">(</span>place <span class="op">=</span> <span class="st">"topleft"</span>, </span>
<span>                                         <span class="co">#grow = TRUE, </span></span>
<span>                                         colour <span class="op">=</span> <span class="st">"white"</span>, </span>
<span>                                         size <span class="op">=</span> <span class="fl">11</span>,</span>
<span>                                         fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">treemapify</span><span class="fu">::</span><span class="fu"><a href="https://wilkox.org/treemapify/reference/geom_treemap_text.html" class="external-link">geom_treemap_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                                place <span class="op">=</span> <span class="st">"centre"</span>, </span>
<span>                                <span class="co">#grow = TRUE, </span></span>
<span>                                alpha <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                                size <span class="op">=</span> <span class="fl">8</span>,</span>
<span>                                fontface <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Migrants Origin Reflects Country History!"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Migrants Region of Origin for G7 Countries | 2020"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Region of Origin"</span>,</span>
<span>       caption <span class="op">=</span> <span class="va">caption</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span>void <span class="op">=</span> <span class="cn">TRUE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/teeemap-plot-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="sankey-diagramme">Sankey Diagramme<a class="anchor" aria-label="anchor" href="#sankey-diagramme"></a>
</h4>
</div>
<div class="section level4">
<h4 id="streamgraph">Streamgraph<a class="anchor" aria-label="anchor" href="#streamgraph"></a>
</h4>
<p>Let’s make a streamgraph showing the evolution of the populations
assisted by UNHCR from 1993 to 2022. For this we will use the <a href="https://github.com/davidsjoberg/ggstream" class="external-link"><code>{ggstream}</code></a>
package.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data.sex.destination.origin</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_destination</span> <span class="op">==</span> <span class="st">"WORLD"</span> <span class="op">&amp;</span></span>
<span>           <span class="va">region_development_group_country_or_area_of_origin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AFRICA"</span>, <span class="st">"ASIA"</span>, <span class="st">"EUROPE"</span>,</span>
<span>                                                                     <span class="st">"LATIN AMERICA AND THE CARIBBEAN"</span>,</span>
<span>                                                                     <span class="st">"NORTHERN AMERICA"</span>, <span class="st">"OCEANIA"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"year"</span>, value <span class="op">=</span> <span class="st">"total_migrants"</span>, <span class="va">total.1990</span><span class="op">:</span><span class="va">total.2020</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"total."</span>, <span class="st">""</span>, <span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         <span class="co">## reorderign the factor levels so it displays better in the chart</span></span>
<span>                region.origin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_origin</span> ,</span>
<span>                                          levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LATIN AMERICA AND THE CARIBBEAN"</span>,</span>
<span>                                                     <span class="st">"NORTHERN AMERICA"</span>,<span class="st">"AFRICA"</span>,</span>
<span>                                                     <span class="st">"ASIA"</span>, <span class="st">"EUROPE"</span>, <span class="st">"OCEANIA"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="co"># Summarize the total migrant population for each region of destination and year</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">region.origin</span>, <span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total_migrants <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total_migrants</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Complete the data to fill in missing years</span></span>
<span><span class="co"># create a smoother streamgraph by interpolating the data points</span></span>
<span><span class="va">complete_data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">region.origin</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/complete.html" class="external-link">complete</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/full_seq.html" class="external-link">full_seq</a></span><span class="op">(</span><span class="va">year</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/fill.html" class="external-link">fill</a></span><span class="op">(</span><span class="va">total_migrants</span>, .direction <span class="op">=</span> <span class="st">"downup"</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co">#sum(data |&gt; filter(year == "2020") |&gt; pull(total_migrants))</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install if needed and load package</span></span>
<span><span class="co"># install.packages("ggstream")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ggstream</span><span class="op">)</span></span>
<span><span class="co"># Create the streamgraph</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">complete_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, </span>
<span>                 y <span class="op">=</span> <span class="va">total_migrants</span>, </span>
<span>                 fill <span class="op">=</span> <span class="va">region.origin</span>, </span>
<span>                 group <span class="op">=</span> <span class="va">region.origin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggstream</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggstream/man/geom_stream.html" class="external-link">geom_stream</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">0.15</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggstream</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggstream/man/geom_stream_label.html" class="external-link">geom_stream_label</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html" class="external-link">str_wrap</a></span><span class="op">(</span><span class="va">region.origin</span>, <span class="fl">20</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">3</span>, n_grid <span class="op">=</span> <span class="fl">100</span> <span class="op">)</span> <span class="op">+</span></span>
<span> <span class="co"># scale_x_discrete( breaks = scales::pretty_breaks(n = 5)) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span> labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Most international migration do originate from Asia!"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Evolution of the number of Migrants per Region of Origin"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">" "</span>,</span>
<span>       y <span class="op">=</span> <span class="st">" "</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Region of Destination"</span>,</span>
<span>       caption <span class="op">=</span> <span class="va">caption</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span> legend <span class="op">=</span> <span class="cn">FALSE</span>, axis_text <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span></code></pre></div>
<p><img src="iomthemes_files/figure-html/stream-plot-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="slope">Slope<a class="anchor" aria-label="anchor" href="#slope"></a>
</h4>
<p>Slop plot (also known as Dumbbell chart, Connected dot plot) is great
for displaying changes between two points in time, two conditions or
differences between two groups.</p>
<p>Let’s create a slope chart showing the evolution of the total refugee
population between 2017 and 2022 in the countries from the East and Horn
of Africa region.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep only 2017 and 2022 records, Load and join region names,</span></span>
<span><span class="co"># Keep only countries in East and Horn of Africa region,</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data.sex.destination.origin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">origin.iso2</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">destination.iso2</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">region_development_group_country_or_area_of_origin</span>,</span>
<span>         <span class="va">region_development_group_country_or_area_of_destination</span>,</span>
<span>         <span class="va">total.2010</span>, <span class="va">total.2020</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> ass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span> <span class="st">"From "</span>,<span class="va">region_development_group_country_or_area_of_origin</span>,</span>
<span>                        <span class="st">" To "</span>,</span>
<span>                        <span class="va">region_development_group_country_or_area_of_destination</span> <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span> <span class="va">ass</span>, <span class="va">total.2010</span>, <span class="va">total.2020</span><span class="op">)</span></span>
<span></span>
<span><span class="va">top_2020</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">total.2020</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">top_2010</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">total.2010</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_merge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">top_2020</span>, <span class="va">top_2010</span> <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> type <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="op">(</span><span class="va">ass</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">top_2020</span><span class="op">$</span><span class="va">ass</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">ass</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">top_2010</span><span class="op">$</span><span class="va">ass</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Constant"</span>,</span>
<span>    <span class="op">(</span><span class="va">ass</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">top_2020</span><span class="op">$</span><span class="va">ass</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="op">(</span><span class="va">ass</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">top_2010</span><span class="op">$</span><span class="va">ass</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Up"</span>,</span>
<span>    <span class="op">!</span><span class="op">(</span><span class="va">ass</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">top_2020</span><span class="op">$</span><span class="va">ass</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">ass</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">top_2010</span><span class="op">$</span><span class="va">ass</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Down"</span>,</span>
<span>    .default <span class="op">=</span> <span class="st">"other"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a DataFrame for the slope chart</span></span>
<span><span class="va">slope_data</span> <span class="op">&lt;-</span> <span class="va">data_merge</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">total.2010</span>, <span class="va">total.2020</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"year"</span>, values_to <span class="op">=</span> <span class="st">"total_migrants"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">year</span>, <span class="st">"total.2010"</span> <span class="op">=</span> <span class="st">"2010"</span>, <span class="st">"total.2020"</span> <span class="op">=</span> <span class="st">"2020"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the slope chart</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">slope_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>,</span>
<span>                       y <span class="op">=</span> <span class="va">total_migrants</span>,</span>
<span>                       group <span class="op">=</span> <span class="va">ass</span>,</span>
<span>                       color <span class="op">=</span> <span class="va">type</span><span class="op">)</span> <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span> data <span class="op">=</span> <span class="va">slope_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="va">year</span> <span class="op">==</span> <span class="st">"2020"</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html" class="external-link">str_wrap</a></span><span class="op">(</span><span class="va">ass</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            <span class="co">#color = "black",</span></span>
<span>           hjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>           vjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>           size <span class="op">=</span> <span class="fl">3</span>, nudge_x <span class="op">=</span> <span class="fl">1</span>,</span>
<span>           direction <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>           segment.size <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>           segment.color <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span> labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Trends in International Migration Corridors"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Top country-to-country Associations"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Total Migrants"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Country of Origin"</span>,</span>
<span>       caption <span class="op">=</span> <span class="va">caption</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span> expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.6</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_iom.html">theme_iom</a></span><span class="op">(</span> grid <span class="op">=</span> <span class="st">"X"</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span></code></pre></div>
<p><img src="iomthemes_files/figure-html/slope-plot-1.png" width="100%"></p>
</div>
</div>
<div class="section level3">
<h3 id="facets">Facets<a class="anchor" aria-label="anchor" href="#facets"></a>
</h3>
<p>Small multiple charts are easy to create with ggplot: it’s called
faceting.</p>
<ul>
<li>With four or more data series, an array of individual charts can
display a pattern and allows better comparison among all lines.</li>
</ul>
<p>If you have data that you want to visualize split up by some
variable, you need to use <code>facet_wrap</code> or
<code>facet_grid</code>.</p>
<p>Add the variable you want to divide by to this line of code:
<code>facet_wrap( ~ variable)</code>.</p>
<p>An additional argument to facet wrap, <code>ncol</code>, allows you
to specify the number of columns.</p>
<p>You may have noticed in the chart above that Oceania, with its
relatively small population, has disappeared completely.</p>
<p>By default, faceting uses fixed axis scales across the small
multiples. It’s always best to use the same y axis scale across small
multiples, to avoid misleading, but sometimes you may need to set these
independently for each multiple, which we can do by adding the argument
<code>scales = "free"</code>.</p>
<p>If you just want to free the scales for one axis set the argument to
<code>free_x</code> or <code>free_y</code>.</p>
</div>
<div class="section level3">
<h3 id="annotation">Annotation<a class="anchor" aria-label="anchor" href="#annotation"></a>
</h3>
<p>To highlight data points within your chart, annotations are the way
forward.</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>We trust that this R package has equipped you with the tools needed
to craft visually appealing <strong>data stories</strong> with ease.</p>
<p>If you need any support, while using this package, please post an
issue in this repository.</p>
<p>If you have any proposals for additional examples to add, please do
submit a pull request.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edouard Legoupil.</p>
</div>

<div class="pkgdown-footer-right">
  <p><a href="https://www.iom.int/" target="_blank" rel="noopener noreferrer" class="external-link"><img src="https://raw.githubusercontent.com/iom/iomtemplate/master/man/figures/logo.svg" alt="IOM logo" style="max-height:2.5rem"></a></p>
</div>

    </footer>
</div>





  </body>
</html>
